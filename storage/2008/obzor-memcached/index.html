<!DOCTYPE html>
<html lang=ru xmlns=http://www.w3.org/1999/xhtml xmlns:og=http://ogp.me/ns# xmlns:fb=https://www.facebook.com/2008/fbml><head><meta http-equiv=Content-Type content="text/html; charset=UTF-8"><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=msapplication-tap-highlight content=no><title>Обзор memcached</title><link href="//fonts.googleapis.com/css?family=Open+Sans&amp;subset=latin,cyrillic" rel=stylesheet type=text/css><link href="//fonts.googleapis.com/css?family=PT+Sans&amp;subset=latin,cyrillic" rel=stylesheet type=text/css><link rel=stylesheet href=https://www.insight-it.ru/theme/css/main.css?5e55de6b><link rel=canonical href=https://www.insight-it.ru/storage/2008/obzor-memcached/ ><meta property=og:url content=https://www.insight-it.ru/storage/2008/obzor-memcached/ ><meta property=og:title content="Обзор memcached"><meta property=og:type content=article><meta name=description content="memcached представляет собой высокопроизводительную распределенную систему кэширования объектов в оперативной памяти. ..."><meta property=og:description content="memcached представляет собой высокопроизводительную распределенную систему кэширования объектов в оперативной памяти. ..."><meta name=keywords content="cash,cashing,daemon,Memcached,информационные технологии,кэш,кэширование,производительность,реализация,технология,unix way"><meta name=author content="Иван Блинков"><meta property=og:site_name content="Insight IT"><meta property=og:locale content=ru_RU><link href=https://www.insight-it.ru/feed/index.xml type=application/rss+xml rel=alternate title="Insight IT RSS Feed"></head><body><header><div class=container><a href=# data-activates=nav-mobile class="button-collapse top-nav waves-effect waves-light circle"><i class=icon-menu></i></a></div><ul id=nav-mobile class="side-nav fixed"><li class=logo><a id=logo-container href=https://www.insight-it.ru/ class=brand-logo><h4>Insight IT</h4></a></li><li class=bold><a href=https://www.insight-it.ru/highload/ > Высокие нагрузки </a></li><li class=bold><a href=https://www.insight-it.ru/interactive/ > Интерактивные сайты </a></li><li class=no-padding><ul class="collapsible collapsible-accordion"><li class=bold><a class="collapsible-header waves-effect waves-red"> Рубрики </a><div class=collapsible-body><ul><li><a href=https://www.insight-it.ru/category/linux/ > Linux </a></li><li><a href=https://www.insight-it.ru/category/python/ > Python </a></li><li><a href=https://www.insight-it.ru/category/erlang/ > Erlang </a></li><li><a href=https://www.insight-it.ru/category/frontend/ > Frontend </a></li><li><a href=https://www.insight-it.ru/category/storage/ > Хранение данных </a></li><li><a href=https://www.insight-it.ru/category/theory/ > Теория </a></li><li><a href=https://www.insight-it.ru/category/event/ > Мероприятия </a></li><li><a href=https://www.insight-it.ru/category/misc/ > Разное </a></li><li><a href=https://www.insight-it.ru/category/index/ > Все рубрики </a></li></ul></div></li></ul></li><li class=no-padding><ul class="collapsible collapsible-accordion"><li class=bold><a class="collapsible-header waves-effect waves-red"> Страницы </a><div class=collapsible-body><ul><li><a href=https://www.insight-it.ru/blog/ > Блог </a></li><li><a href=https://www.insight-it.ru/about/ > О сайте </a></li><li><a href=https://www.insight-it.ru/author/ > Об авторе </a></li><li><a href=https://www.insight-it.ru/consulting/ > Консультации </a></li><li><a href=https://www.insight-it.ru/contact/ > Контакты </a></li><li><a href=https://www.insight-it.ru/resume/ > Резюме </a></li><li><a href=https://www.insight-it.ru/search/ > Поиск по сайту </a></li></ul></div></li></ul></li></ul></header><main><nav class=top-nav><div class=container><div class=nav-wrapper><ul id=nav-mobile class="right hide-on-med-and-down"><li class><a href=/blog/ >Блог</a></li><li class><a href=/about/ >О&nbsp;сайте</a></li><li class><a href=/author/ >Об&nbsp;авторе</a></li></ul><h1><a class=page-title> Обзор memcached </a></h1></div></div></nav><div class=container><div class=row><div class="col s12 m9 l10"><div class="materialdesign section scrollspy"><section id=content class=body><article class=entry-content><p><a href=https://www.insight-it.ru/goto/62123c99/ rel=nofollow target=_blank title=http://www.danga.com/memcached/ ><strong>memcached</strong></a> представляет собой высокопроизводительную распределенную систему кэширования объектов в оперативной памяти.</p><p>Оформлена она в виде классического <a href=/tag/daemon/ >daemon</a>'а, слушающего подключения на одном из TCP-портов (по-умолчанию: 11211). Работа же с ним осуществляется с помощью клиентских библиотек, доступных практически для всех популярных языков программирования. </p><p><a href=/tag/memcached/ >memcached</a> не использует конфигурационные файлы, но все же может быть в какой-то степени настроен под свои нужды с помощью параметров, указываемых при запуске <a href=/tag/daemon/ >daemon</a>'а, и переменных окружения. Например, часто используется параметр <strong>-m</strong>, позволяющий указать объем используемой для хранения объектов оперативной памяти. По сути кэширование с помощью <a href=/tag/memcached/ >memcached</a> представляет собой некое подобие глобального ассоциативного массива, то есть набора соответствий <em>ключ &rarr; объект</em>.</p><h3 id=kak-zhe-ono-rabotaet>Как же оно работает?</h3><p>Принцип очень прост: после установления соединения между клиентом (произвольное приложение, воспользовавшееся услугами одной из клиентских библиотек) и сервером (распределенной системой, состоящей из <a href=/tag/daemon/ >daemon</a>'ов), клиенту предоставляется возможность выполнять четыре примитивных действия для организации кэширования:</p><ul><li><strong>set</strong> - установить соответствие между ключом и указанным объектом;</li><li><strong>add</strong> - аналогично <em>set</em>, но только при условии, что объекта с таким ключом в кэше нет;</li><li><strong>replace</strong> - абсолютная противоположность <em>add</em>, выполняется только если такой объект в кэше есть;</li><li><strong>get</strong> - получить объект из кэша по указанному ключу.</li></ul><p>Вывод напрашивается лишь один: проще не придумаешь.</p><h3 id=v-sravnenii>В сравнении</h3><p>Многие <a href=/tag/subd/ >СУБД</a> предоставляют встроенные средства кэширования, но на практике они умеют кэшировать только результаты запросов, что не всегда является именно тем, что необходимо веб-приложению. СУБД обычно полностью очищают кэш таблицы при каждом изменении данных, что приводит к полной его бесполезности при активном обновлении таблиц.</p><p>Еще один альтернативный вариант кэширования может предоставить http-сервер, в большинстве случаев кэш дублируется несколько раз для каждого процесса <a href=/tag/php/ >PHP</a>, <a href=/tag/perl/ >Perl</a> или любого другого используемого языка программирования. Помимо излишних затрат оперативной памяти, такой вариант развития событий еще и снижает эффективность самого кэша.</p><h3 id=na-praktike>На практике</h3><p>Использование <a href=/tag/memcached/ >memcached</a> на практике в написании приложений ничуть не сложнее, чем в теории. Например, если говорить о <a href=/tag/php/ >PHP</a>, то для доступа к <a href=/tag/daemon/ >daemon</a>'y достаточно установить соответствующий <a href=https://www.insight-it.ru/goto/a0e58a5c/ rel=nofollow target=_blank title=http://pecl.php.net/package/memcache>PECL extension</a>, который предоставит класс <strong>Memcached</strong>. С помощью его методов осуществляется доступ ко всем возможностям <a href=/tag/memcached/ >memcached</a>, о которых я уже упоминал: <strong>connect</strong>, <strong>set</strong>, <strong>add</strong>, <strong>get</strong> и так далее.</p><p>Для многих других языков программирования также существуют API, список которых можно <a href=https://www.insight-it.ru/goto/94c7c37e/ rel=nofollow target=_blank title=http://www.danga.com/memcached/apis.bml>найти на официальном сайте</a>.</p><h3 id=o-chem-ne-stoit-zabyvat>О чем не стоит забывать</h3><p><em>Кэш не является базой данных!</em> Не стоит забывать, что кэш является <em>очень</em> ненадежным местом хранения данных, не предоставляет избыточности и каких-либо гарантий, что сохраненная в нем информация будет доступна через какое-то время. За производительность приходится платить.</p><h3 id=v-zakliuchenii>В заключении</h3><p>...хотелось бы сказать, что эта <a href=/tag/tekhnologiya/ >технология</a> является очень производительным и эффективным решением вопроса кэширования для масштабных интернет-проектов. Возможности по ее применению не ограничиваются Сетью, ведь она реализована в виде обычного daemon'а, что открывает ее для всего спектра программного обеспечения, так или иначе следующего <a href=/tag/unix-way/ >"Unix&nbsp;way"</a>.</p><div class=sharrre-wrapper><div class=twitter data-url=https://www.insight-it.ru/storage/2008/obzor-memcached/ data-text="Обзор memcached" data-title=Tweet></div><div class=facebook data-url=https://www.insight-it.ru/storage/2008/obzor-memcached/ data-text="Обзор memcached" data-title=Like></div><div class=linkedin data-url=https://www.insight-it.ru/storage/2008/obzor-memcached/ data-text="Обзор memcached" data-title="In Share" ></div></div><div class="card-panel light-blue darken-2 light-blue-text text-lighten-4"><span class=published title=2008-02-21T18:08:00+03:00>21 февраля 2008</span>&nbsp;|&nbsp;<span class="vcard author"><a class="url fn light-blue-text text-lighten-4" href=https://www.insight-it.ru/author/ > Иван Блинков </a></span>&nbsp;|&nbsp;<a href=https://www.insight-it.ru/category/storage/ class="light-blue-text text-lighten-4" > Хранение данных </a>&nbsp;|&nbsp;<a href=https://www.insight-it.ru/storage/2008/obzor-memcached/#comments class="light-blue-text text-lighten-4" title="48 комментариев"> 48 <i class=icon-chat></i></a></div><div class=taglist class=row><a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/cash/ > cash </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/cashing/ > cashing </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/daemon/ > daemon </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/memcached/ > Memcached </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/informatsionnye-tekhnologii/ > информационные технологии </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/kesh/ > кэш </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/keshirovanie/ > кэширование </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/proizvoditelnost/ > производительность </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/realizatsiia/ > реализация </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/tekhnologiia/ > технология </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/unix-way/ > unix way </a>&ensp;</div></footer></article></section></div><div class=after><div id=comments><h4>48 комментариев</h4><ul class=comments-list><li class=comment><em>Алексей, 2010-10-09T11:42:47:<em> Спасибо, очень интересная статья. </li><li class=comment><em>CyberMax, 2010-04-14T07:00:08:<em> А если у меня на сервере уже установлен XCache то есть ли смысл memcached устанавливать? А они не будут конфликтовать? <ul class=children><li class=comment><em>Ivan Blinkov, 2010-04-22T08:36:12:<em> CyberMax, не будут, смысл есть. </li></ul></li><li class=comment><em>Иван Блинков, 2009-09-16T09:07:21:<em> В рамках одного memcached-сервера кэш общий, если все потоки используют один и тот же сервер - они будут пользоваться одним общим кэшем. </li><li class=comment><em>Вадим, 2009-09-15T16:14:04:<em> Спасибо! Отличная статья.Вот только один вопрос остался для меня не проясненным.Если использовать memcached в контексте веб-приложения, скажем, написанного на php, то будет использоваться один общий кэш для всех потоков php, либо для каждого будет создаваться своя "песочница"? </li><li class=comment><em>Сергей, 2009-06-05T07:01:16:<em> По поводу инвалидации, можно сделать кэширование запросов, касающихся определенного пользователя (пользоватлей), а при записи, зная, какой (какие) пользователи затрагиваются, вычищать кэш. Не очень сложно, но довольно эффективно, т.к. даже при частых записях в БД, каждый конкретный пользователь почти всё время читает. </li><li class=comment><em>Alexandre, 2009-04-27T08:31:32:<em> протокол memсache реализован на двух демонах- memcached- memcachedbв отличие от первого - второй умеет сохранять хеш-данные на диски, что повышает надежность при случайном сбое системы </li><li class=comment><em>freelancer, 2009-04-15T10:56:00:<em> Действительно просто. Думаю для проектов меншего масштаба можно использовать обычный ассоциативный массив с некоторой логикой удаления устаревших данных вместо memcache </li><li class=comment><em>ReLoader, 2008-10-15T15:31:18:<em> [quote comment="1434"]народ, подскажите плиз, можно ли использовать memcached для хранения сессий если серверов несколько?...................чувствую что-то здесь не так :)[/quote]Выполняется достаточно просто - на одном сервере(любом, например фронтэнде или сервере БД) поднимаем демона мемкеша.На бэкэндах к php доставляем модуль мемкэш (http://pecl.php.net/package/me..., в php.ini заменяем строчкуsession.save_handler = filesнаsession.save_handler = memcachesession.save_path = "tcp://memcache-server:11211"и добавляемextension=memcache.so[memcache]memcache.dbpath="/var/lib/memcache"Это и переопределяет обработку сессий для всех пхп скриптов.Недостаток - при падении/рестарте мемкэша теряем текущие сесии. Но как вариант можно делать дамп кэша в файл... </li><li class=comment><em>Иван Блинков, 2008-10-09T11:18:34:<em> [quote comment="1433"]при мыслях об использовании мемкеша помните важные ограничения:ключи не более 250 байт,данные не более 1мб на ключ.[/quote]Это уже детали... для того чтобы в них упереться надо сильно постараться, я на практике не сталкивался с ними ни разу, например...[quote comment="1434"]народ, подскажите плиз, можно ли использовать memcached для хранения сессий если серверов несколько? у меня есть один прокси сервер и 3 backend сервера которые обрабатывают только PHP запросы. сейчас сессии лежат в БД что существенно присаживает базу (отдельный сервер). хочу перенести сессии в кеш, но как их синхронизировать между серверами - незнаю. и как-то не нашел никаких толковых решений. переопределял сам обработку сессиий в РНР, коннектился ко всем демонам, клал туда одинаковые данные...чувствую что-то здесь не так :)[/quote]Зависит от языка программирования, но в целом можно, при желании можно даже нагуглить готовые решения. </li><li class=comment><em>Алексей, 2008-10-08T18:50:55:<em> народ, подскажите плиз, можно ли использовать memcached для хранения сессий если серверов несколько? у меня есть один прокси сервер и 3 backend сервера которые обрабатывают только PHP запросы. сейчас сессии лежат в БД что существенно присаживает базу (отдельный сервер). хочу перенести сессии в кеш, но как их синхронизировать между серверами - незнаю. и как-то не нашел никаких толковых решений. переопределял сам обработку сессиий в РНР, коннектился ко всем демонам, клал туда одинаковые данные...чувствую что-то здесь не так :) </li><li class=comment><em>Nik, 2008-10-08T18:28:28:<em> при мыслях об использовании мемкеша помните важные ограничения:ключи не более 250 байт,данные не более 1мб на ключ. </li><li class=comment><em>Олег, 2008-06-25T19:09:01:<em> Примерное месяца назад стал использовать мемкэш для разработки системы обмена сообщений между пользователями сайта. Вместе с UPDATE и memcache оказалось очень эффективной системой.Если кэш вдруг исчезнет то всегда придет на помощь база данных.Выигрыш: при частом обмене сообщений - только один быстрый запрос на UPDATE и ВСЕ!!! </li><li class=comment><em>Иван Блинков, 2008-05-27T16:40:19:<em> [quote comment="806"]но интересно ваше мнение - кэшировать строки таблицы и/или "вспомогательные" сущности(модели) которые более затратны по выборке, но менее используемы?[/quote]Абстрагировавшись от конкретной задачи, отвечать на этот вопрос бессмысленно - к каждому проекту необходим индивидуальный подход. </li><li class=comment><em>Victor, 2008-05-27T14:39:21:<em> До каких пор кэшировать... Тут вопрос в том что есть базовые сущности - объекты которые безусловно кэшируются (по сути сроки таблиц: мембера, заметки, ресторана и тд), и есть допустим "вспомогательные" сущности(модели), которые формируются из разных таблиц путем объединения, и тд. Их тоже хранить? или писать статические "классы-хелперы", которые будут выбирать и компоновать "вспомогательные" сущности непосредственно в коде из закэшированых базовых сущностей. Пока писал, кое что понял), но интересно ваше мнение - кэшировать строки таблицы и/или "вспомогательные" сущности(модели) которые более затратны по выборке, но менее используемы? </li><li class=comment><em>Kudzu, 2008-05-25T22:52:21:<em> [quote comment="241"]Как обычно я выступлю с вопросом о примере юзкейса. Техническая сторона освещена, но как это используется в интернет проектах на практике?Ну хоть один пример.Спасибо.[/quote]Например, есть две огромных массива, в одном храним пул айпи адресов, в другом занятые айпи адреса, пользователю нужно выдать айпишник, сраниваем два массива, получаем массив свободных, берем первый незщанятый. Самый просто вараинт, хранить последний массив в кеше, при протухании обновлять и не забывать о блокировках. </li><li class=comment><em>Иван Блинков, 2008-05-15T20:05:25:<em> [quote comment="717"]А как решать вопрос транзакций? Т.е. обновляем данные в базе, в кеше.Но в случае ролбека данные в кеше остаются недостоверные.[/quote]От конкретного приложения зависит... либо не трогать кэш до commit'а, либо обновлять его параллельно с транзакцией, но в случае rollback'а принудительно синхронизировать с откатившейся базой все потенциально затронутые этим процессом объекты. Или, как вариант, можно держать в кэше две версии нужной части данных: текущую и на момент на начала транзакции, в случае rollback'а достаточно будет просто подменить одну другой (но это будет эффективно, возможно, только при большой вероятности окончания транзакции rollback'ом). </li><li class=comment><em>Сергей, 2008-05-15T16:33:34:<em> А как решать вопрос транзакций? Т.е. обновляем данные в базе, в кеше.Но в случае ролбека данные в кеше остаются недостоверные.Пока придумал только варинат накапливать изменения в программе, и только перед самым комитом делать массовый апдейт кеша. Еще есть идеи? </li><li class=comment><em>Иван Блинков, 2008-04-13T10:12:40:<em> [quote comment="532"][quote comment="525"]...При этом выборка с объединением по некоторым условиям производится долго. ...[/quote]Тут появилась идея что в случае удаления кэша несколько веб-процессов одновременно могут постараться его обновить, а так как процесс генерации долгий, то это может нагрузить базу одинаковыми запросами от разных клиентов. Я бы отдал задачу обновления кэша асинхронному процессу с собственной логикой слежения. В данном варианте веб-скрипты должны читать только кэш, а к базе не обращаться.[/quote]Если данные приложения обновляются настолько часто, что возможно возникновения таких ситуаций, то стоит задуматься об отказе от кэширования этих данных. А асинхронные процессы конечно тоже можно инициализировать, но нужно ли? </li><li class=comment><em>Безымянный, 2008-04-12T02:57:53:<em> [quote comment="525"]...При этом выборка с объединением по некоторым условиям производится долго. ...[/quote]Тут появилась идея что в случае удаления кэша несколько веб-процессов одновременно могут постараться его обновить, а так как процесс генерации долгий, то это может нагрузить базу одинаковыми запросами от разных клиентов. Я бы отдал задачу обновления кэша асинхронному процессу с собственной логикой слежения. В данном варианте веб-скрипты должны читать только кэш, а к базе не обращаться. </li><li class=comment><em>Иван Блинков, 2008-04-11T05:47:10:<em> [quote comment="525"]Можете еще раз в трех словах объяснить принцип? Допустим у меня есть база из нескольких таблиц размером в 1000 000 записей. При этом выборка с объединением по некоторым условиям производится долго. Что мне нужно, чтобы проверить - если такой результат уже выбран - берем из кеша, если нет - задаем запрос?То есть в трех словах, как это работает на пальцах. И еще - каким образом информировать, что база была обновлена, а именно, что участвующие в результате запроса записи обновлены и надо их удалить из кеша?[/quote]Кэшируются не запросы, а объекты любого языка программирования, с кэшированием запросов прекрасно справляются сами СУБД.Но если очень хочется. то можно и с использованием memcached это реализовать, я бы это примерно так сделал:<ul><li>сначала нужно придумать систему уникальных идентификаторов (например, в соответствие запросу select * from accounts where id < 1000; поставим в соответствие ключ accounts_below_1000 и для остальных выборок по аналогии);</li><li>делаем в первый раз выборку;</li><li>преобразуем в массив результат;</li><li>сразу же заносим в memcached с выбранным ключом;</li><li>работаем с массивом дальше;</li><li>при повторной необходимости в этих данных сначала смотрим в кэш, если там пусто, то снова формируем запрос к СУБД;</li><li>если же какие-либо данные обновились то помимо отправки запроса к СУБД надо еще в той же функции пройтись по кэшу и его обновить.</li></ul>Правда сомневаюсь что такой подход наиболее эффективен (особенно при частых обновлениях старых данных), я обычно предпочитаю делать выборки по id строк, а потом уже каждую строку отдельно вытаскивать из memcached, а кэширование выборок оставить на совести СУБД (или вообще без него обойтись). </li><li class=comment><em>Play, 2008-04-11T03:44:18:<em> Можете еще раз в трех словах объяснить принцип? Допустим у меня есть база из нескольких таблиц размером в 1000 000 записей. При этом выборка с объединением по некоторым условиям производится долго. Что мне нужно, чтобы проверить - если такой результат уже выбран - берем из кеша, если нет - задаем запрос?То есть в трех словах, как это работает на пальцах. И еще - каким образом информировать, что база была обновлена, а именно, что участвующие в результате запроса записи обновлены и надо их удалить из кеша? </li><li class=comment><em>Безымянный, 2008-04-10T17:28:55:<em> [quote comment="516"]Все просто:...Быстро и эффективно.[/quote]Спасибо!!! </li><li class=comment><em>Иван Блинков, 2008-04-10T16:05:56:<em> [quote comment="517"] "материализованные представления" Оракла (предпочтительнее)[/quote]Это ведь materialized views имелись ввиду? Если да, то они вполне реализуемы средствами opensource CУБД (PostgreSQL и MySQL - точно).Правда если я правильно представляю себе принцип их работы - они хранятся наравне с обычными таблицами в файловой системе и каких-либо особых средств кэширования в оперативной памяти не представляют. Рост производительности достигается лишь за счет упрощения запросов и асинхронности выполнения вычислений. </li><li class=comment><em>Карма, 2008-04-10T15:51:10:<em> 2Дмитрий Тимохов:если вам не обязательно соблюдать требования свободного ПО для своей задачи, вполне возможно подойдут "материализованные представления" Оракла (предпочтительнее), или "индексированные представления" MS SQL </li><li class=comment><em>Иван Блинков, 2008-04-10T15:10:06:<em> Все просто:<ul><li>система распределенная, то есть количество серверов, выделяющих оперативную память под кэш не ограничено;</li><li>программа-клиент при подключении указывает весь список серверов с запущенным memcached;</li><li>при выполнении обращения к кэшу ключ (строка-идентификатор объекта) пропускается через две хэшируещие функции;</li><li>на первом шаге однозначно определяется номер сервера из списка (выглядит примерно как: n=CRC32("key")%c, где n - номер сервера, а c - количество серверов);</li><li>на втором шаге однозначно определяется адрес в оперативной вычисленного сервера по которому хранятся требуемые данные;</li><li>далее данные возвращаются приложению по сети (если конечно тот сервер memcached находился не на той же физической машине);</li></ul>Быстро и эффективно. </li><li class=comment><em>Безымянный, 2008-04-10T14:41:12:<em> Неужели ответ: Выделенный сервер с 1 ТБ оперативки :-) , слушающий на TCP 11211 ?А если веб серверов становится уже 100 и один memcached сервер с ними не справляется, то нужно делить веб сервера на группы с отдельными memcached серверами?Хотелось бы почитать чьё-то мнение по этому поводу... </li><li class=comment><em>Безымянный, 2008-04-10T14:35:45:<em> Спасибо за эту статью и за все остальные тоже!А как же оно работает когда у вас 10 серверов? Где кэшировать чтобы все сервера доступ имели? Клиент то на любой сервак упасть может, а там нужного кэша не будет. </li><li class=comment><em>Иван Блинков, 2008-04-07T17:58:47:<em> [quote comment="490"]Насчет сброса кеша: самый простой и эффективный алгоритм - задавать время жизни кэша. То есть сидит некий демонок, у которого записано: вот эту группу ключей хранить 1 минуту, а вот эту - день. как время истекло, он трёт соотв. ключи. Если они никому бельше не нужны были - и ладно, если данные в кеше востребованы, то они перегенерятся заново из БД.Да, есть накладки по производительности (если данные не изменились, но были потёрты - запрос опять к СУБД пойдет), но они решаются грамотным распределением времен жизни кэша.[/quote]Memcached прекрасно это умеет собственными средствами, не об этом разговор был... </li><li class=comment><em>Сугубый, 2008-04-07T12:25:14:<em> Насчет сброса кеша: самый простой и эффективный алгоритм - задавать время жизни кэша. То есть сидит некий демонок, у которого записано: вот эту группу ключей хранить 1 минуту, а вот эту - день. как время истекло, он трёт соотв. ключи. Если они никому бельше не нужны были - и ладно, если данные в кеше востребованы, то они перегенерятся заново из БД.Да, есть накладки по производительности (если данные не изменились, но были потёрты - запрос опять к СУБД пойдет), но они решаются грамотным распределением времен жизни кэша. </li><li class=comment><em>Иван Блинков, 2008-02-25T21:30:46:<em> Возможно мы о чем-то разном говорим, я как раз стараюсь избегать зависимости хранимых данных от чего-либо, кроме Primary Key в таблице, или ключа в кэше (в Вашем примере - курса), что собственно говоря в теории реляционных СУБД и называют нормализацией. Где я не прав?Возможно для редко обновляемых данных и менее эффективно, чем кэширование финальных результатов, но зато не требует каких-либо алгоритмов для обеспечения целостности данных. </li><li class=comment><em>Дмитрий Тимохов, 2008-02-25T20:33:19:<em> >Я для себя этот вопрос решил просто исключением возможности >нормализацией базы ровно до той степени, что необходимость в подобных >проверках отпала (правда я это заранее сделал, но не суть…)Что-то я Вас, Иван, не понимаю.Вот простой пример - есть курс доллара и 100 РАЗНЫХ отчетов, которые опираются на этот курс. При разработке кеша нужно выявить ВСЕ отчеты, которые зависят от курса. При работе системы и модификации курса нужно выявить все сохраненные в кеше отчеты, зависящие от курса, и удалить их или пометить, что они не валидны.Т.е. как бы ВОПРОС - при чем здесь нормализация? </li><li class=comment><em>Иван Блинков, 2008-02-24T21:15:08:<em> [quote comment="259"]> возможно просто так как я не удосужился зарегистрироватьсяну это же чертовски логично - под каким ключем сервер должен держать ваши данные, если нет регистрации? серийный номер винта? мак-адрес?[/quote]Сложно поспорить, хотя я если честно вообще не вижу смысла эту информацию хранить =)[quote comment="259"]Однако вопрос инвалидации кеша стоит все же остро. О сбросе кеша я задумывался и раньше, когда думал о кеше. И в общем случае не нашел решения, кроме того, чтобы в деталях разбирать КАЖДЫЙ updata или insert в БД, а имеено - на какие данные он повлияет. Нужно определять ВСЕ возможные сохраненные данные, которые зависят от проводимого update или insert.[/quote]Я для себя этот вопрос решил просто исключением возможности нормализацией базы ровно до той степени, что необходимость в подобных проверках отпала (правда я это заранее сделал, но не суть...)[quote comment="259"]ВОПРОС. Иван, не заете ли Вы открытых исходников, которые используют MC?[/quote]Да все тот же LiveJournal, на их сайте из SVN можно забрать. </li><li class=comment><em>Дмитрий Тимохов, 2008-02-24T20:09:51:<em> > возможно просто так как я не удосужился зарегистрироватьсяну это же чертовски логично - под каким ключем сервер должен держать ваши данные, если нет регистрации? серийный номер винта? мак-адрес?--------За последние сутки я немало прочел про memcached. Действительно, штука может быть очень полезной. Ничего в ней новой по сути нет - я сам думал что-то подобное написать для себя, если пойду в сторону веба. Если кто-то написал, то тем лучше :).Однако вопрос инвалидации кеша стоит все же остро. О сбросе кеша я задумывался и раньше, когда думал о кеше. И в общем случае не нашел решения, кроме того, чтобы в деталях разбирать КАЖДЫЙ updata или insert в БД, а имеено - на какие данные он повлияет. Нужно определять ВСЕ возможные сохраненные данные, которые зависят от проводимого update или insert.ВОПРОС. Иван, не заете ли Вы открытых исходников, которые используют MC? </li><li class=comment><em>Иван Блинков, 2008-02-23T17:44:23:<em> [quote comment="253"]хранит их все-таки сервер. я обычно карзину набираю в течении месяца с 3 разных компьютеров. не в кукисах дело. к тому же я их чищу раз в неделю везде.[/quote]Хм, возможно конечно, но мою он благополучно очистил, после удаления соответствующих cookies (возможно просто так как я не удосужился зарегистрироваться). Хотя не в этом конечно суть, если магазин считает содержимое корзины важной информацией, то никто запретить ему хранить эту информацию не может. </li><li class=comment><em>Дмитрий Тимохов, 2008-02-23T17:23:38:<em> хранит их все-таки сервер. я обычно карзину набираю в течении месяца с 3 разных компьютеров. не в кукисах дело. к тому же я их чищу раз в неделю везде. </li><li class=comment><em>Иван Блинков, 2008-02-23T16:55:28:<em> [quote comment="251"]>> (дублирование в базу данных до подтверждения заказа излишне)ну это зависит от задачи. www.books.ru, например, хранит мою корзину без подтверждения.[/quote]Только хранит ее не сайт, а браузер в виде cookies.[quote comment="251"]ну собственно один из алгоритмов, которые я нарыл за последние 2 часа таков: если нужно актуализировать состояние кеша в соответствии с изменениями в БД, то можно сделать тригер, в котором сливать изменения в спец. таблицу, потом вытигивать данные из таблицы и затирать устаревшие значения в кеше.[/quote]Не вижу ни одного преимущества такого подхода перед занесением в кэш новой информации одновременно с запросом в базу данных. Хотя конечно же это не означает, что их нет... </li><li class=comment><em>Дмитрий Тимохов, 2008-02-23T16:47:06:<em> >> (дублирование в базу данных до подтверждения заказа излишне)ну это зависит от задачи. www.books.ru, например, хранит мою корзину без подтверждения.ну собственно один из алгоритмов, которые я нарыл за последние 2 часа таков: если нужно актуализировать состояние кеша в соответствии с изменениями в БД, то можно сделать тригер, в котором сливать изменения в спец. таблицу, потом вытигивать данные из таблицы и затирать устаревшие значения в кеше. </li><li class=comment><em>Иван Блинков, 2008-02-23T16:31:31:<em> Зачем такие сложности? Алгоритм работы в общем случае укладывается в мой предыдущий комментарий, а конкретно для Вашего примера достаточно просто приделать memcached к PHP в качестве обработчика сессий, в котороых и хранить состояние корзины (дублирование в базу данных до подтверждения заказа излишне).Для каких-нибудь специфических случаев возможно и нужен нетривиальный алгоритм, но мне почему-то они в голову не приходят... </li><li class=comment><em>Дмитрий Тимохов, 2008-02-23T14:48:11:<em> Еще добавочка по результатам чтения сайта разработчика. Идейно все действительно очень понятно: все что можно - это положить значение в кеш и взять его из него.Но я хочу сказать, что в общем случае для определения того, влекут ли изменения в БД изменения в одном из закешированных значений, может потребоваться весьма нетривиальный алгоритм. И, насколько я понял (если не прав, то поправьте, пожалуйста), разработка такого алгоритма ложится на плечи разработчика системы. Или я что-то не так понимаю? </li><li class=comment><em>Дмитрий Тимохов, 2008-02-23T14:19:55:<em> Идейно, я думаю, здесь сложно выразиться не ясно: идейно все ясно и понятно.Я алгоритм представляю примерно так:1. Клиент обращается с запросом - например, вывести состояние корзины заказов.2. Сервер строит результат. Результат возвращается клиенту.3. Сервер создает на основе параметров запроса некий ключ (хоть CRC считает). Под этим ключом данные попадают в кеш.4. При следующем запросе сервер сначала ищет ключ в кеше, если нашел, то возвращает результат клиенту, если не нашел, то см. п. 2.При этом - каким образом данные обновляются в кеше? Я так понимаю, что в пред. список надо добавить п. 3.5: клиент изменил позиции в своей корзине, при этом нужно: а) сделать изменения в БД; б) удалить все возможные кешированные данные, которые зависят от проводимых в БД изменений.Наверное примерно так? </li><li class=comment><em>Иван Блинков, 2008-02-23T09:33:29:<em> Может быть я немного не ясно выразил этот принцип в самом посте: проверяется наличие данных в кэше, в случае отсутствия - достаем из СУБД. Все изменения дублируются в кэше и базе данных.По крайней мере я себе это так представляю... </li><li class=comment><em>Дмитрий Тимохов, 2008-02-23T08:56:20:<em> Про LJ спасибо посмотрел. Все же как-то поверхностно :)Сейчас я попытаюсь пояснить суть своего вопроса.У меня есть прогрмма в разработке: математическая модель фирмы. Данная программа имеет большой объем данных, которые вычисляются рекурентно. Я пошел по пути полной нормализации - хранятся только управляющие параметры, все остально считается. Если не использовать никаких методик повышения производительности, то расчеты проводятся чудовищно долго. Кеширование НЕИЗМЕННЫХ данных на каждом уровне рекурсии повзволяет на порядки повысить производительность (эдак порядка на 4 :))У меня примерно так - перед расчетом я проверяю не увеличился ли timestamp со времени последнего расчета? Если увеличился, то делаю перерасчет, если нет, то использую старые данные.К чему это я и почему я выделил слово "неизменных"? Потому, что я в своей модели знаю, что данные неизменны, потому я их и кеширую.ТЕПЕРЬ О MEMCAHCED. Под примером я просил вот что. При использовании систем кеширования возникает вопрос - пересчитывать ли данные или брать из кеша. Как это сделано у меня я сказал. Мне был бы интересен в деталях пример того, как, скажем, тот же LJ, решает - обращаться ли к MySql или брать из кеша. Какой критерий можно использовать? Как узнать, что данные с момента последнего расчета не изменились и их можно брать из кеша?--Прошу прощения за ошибки. Просто у меня в оперет размер символов равен примерно 5-6 кеглей (как муравьи :)). </li><li class=comment><em>Иван Блинков, 2008-02-23T08:39:11:<em> [quote comment="241"]Как обычно я выступлю с вопросом о примере юзкейса. Техническая сторона освещена, но как это используется в интернет проектах на практике?Ну хоть один пример.Спасибо.[/quote]За примерами далеко ходить не надо: LiveJournal.com - специально для него memcached изначально и разрабатывался. Можно даже процитировать официальный сайт проекта: ...благодаря memcached нагрузка на базы данных упала до минимума, что привело к более быстрым загрузка страниц, более эффективному использованию ресурсов, а также к более быстрому доступу к БД в случае отсутствия информации в кэше.По поводу работы LJ есть презентация, правда там про все вместе. Кэширование начинается с 49 слайда. Еще могу предложить список проектов, использующих memcached, тоже впечатляет, даже при том, что он явно далеко не полный. </li><li class=comment><em>Дмитрий Тимохов, 2008-02-23T07:52:46:<em> Как обычно я выступлю с вопросом о примере юзкейса. Техническая сторона освещена, но как это используется в интернет проектах на практике?Ну хоть один пример.Спасибо. </li><li class=comment><em>Sergey Shepelev, 2008-02-22T11:54:27:<em> Спасибо, отличная вводная. Кратко и по делу. </li><li class=comment><em>Иван Блинков, 2008-02-22T08:05:08:<em> [quote comment="233"]Скажите а есть ли еще какие-то столь же простые и удобные технологии для повышения производительности в нагруженных проектах? Которые можно например использовать в связке с мemcached?[/quote]При прочтении этого вопроса мне почему-то в голову пришла связка из Hadoop+HBase+HDFS, но на данный момент я, пожалуй, не готов написать какой-либо подобный пост об этой системе, так как сам еще нахожусь в процессе осознавания принципов ее функционирования, особенно с интеграцией в разнообразные языки программирования там не очень хорошо дела обстоят. </li><li class=comment><em>Gorky, 2008-02-22T07:47:47:<em> Хм, по мемкэш слышал уже не раз, то тут, то там, и вы упоминали при описании архитектуры больших проектов. Скажите а есть ли еще какие-то столь же простые и удобные технологии для повышения производительности в нагруженных проектах? Которые можно например использовать в связке с мemcached? </li></ul></div><script type=text/javascript>
        var disqus_shortname = 'insight-it';
        var disqus_identifier = '46 http://www.insight-it.ru/unix-way/obzor-memcached/';
        var disqus_url = 'https://www.insight-it.ru/storage/2008/obzor-memcached/';
        var disqus_domain = 'disqus.com';
        var disqus_title = 'Обзор memcached';
        var disqus_container_id = 'comments';
        (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//insight-it.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script></div></div><div class="col hide-on-small-only m3 l2"><div class=card><a href=https://www.insight-it.ru/author><div class="card-image tooltipped" data-position=top data-delay=50 data-tooltip="Автор Insight IT"><img src=https://www.insight-it.ru/images/avatar.jpeg><span class=card-title>Иван Блинков</span></div></a></div><div class=toc-wrapper><div style="height: 1px;"><ul class="section table-of-contents"><li><a href=# title="Обзор memcached">Обзор memcached</a><li><a href=#kak-zhe-ono-rabotaet title="Как же оно работает?">Как же оно работает?</a></li><li><a href=#v-sravnenii title="В сравнении">В сравнении</a></li><li><a href=#na-praktike title="На практике">На практике</a></li><li><a href=#o-chem-ne-stoit-zabyvat title="О чем не стоит забывать">О чем не стоит забывать</a></li><li><a href=#v-zakliuchenii title="В заключении">В заключении</a></li></li></ul></div></div></div></div></div></main><footer class=page-footer><div id=footer class=container><div class=row><div class="col m4 s12"><h5 class=white-text>Иван Блинков</h5><ul><li><a href=mailto:insight-it@blinkov.ru rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-mail white-text"></i> insight-it@blinkov.ru </span></a></li><li><a href=https://www.linkedin.com/in/ivanblinkov rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-linkedin light-blue-text text-darken-3"></i> LinkedIn </span></a></li><li><a href=https://twitter.com/blinkov rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-twitter cyan-text text-accent-2"></i> @blinkov </span></a></li><li><a href="http://plus.google.com/102882395551389724078?rel=author" rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-gplus red-text"></i> Google </span></a></li><li><a href=https://www.facebook.com/ivan.blinkov rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-facebook blue-text text-darken-3"></i> Facebook </span></a></li><li><a href=https://www.insight-it.ru/feed/ rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-rss orange-text"></i> Подписаться по RSS </span></a></li></ul><a href=//feeds.feedburner.com/insight-it/feed target=_blank rel="external nofollow"><img src="//feeds.feedburner.com/~fc/insight-it/feed?bg=b3e5fc&amp;fg=222222&amp;anim=1" height=26 width=88></a>&nbsp;<a href=//twitter.com/blinkov target=_blank rel="external nofollow"><img src=//button.twittercounter.com/animated/blinkov/222222/b3e5fc width=88 height=26></a></div><div class="col m4 s12"><h5 class=white-text>Рубрики</h5><ul><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/highload/ > Высокие нагрузки </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/interactive/ > Интерактивные сайты </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/linux/ > Linux </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/python/ > Python </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/erlang/ > Erlang </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/storage/ > Хранение данных </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/frontend/ > Frontend </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/theory/ > Теория </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/event/ > Мероприятия </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/misc/ > Разное </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/php/ > PHP </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/security/ > Безопасность </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/vacancy/ > Вакансии </a></li></ul><h5 class=white-text>Навигация</h5><ul><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/blog/ >Блог</a></li><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/about/ >О&nbsp;сайте</a></li><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/author/ >Об&nbsp;авторе</a></li></ul></div><div class="col m4 s12"><h5 class="white-text center-align">Теги</h5><div class="tagcloud taglist"><span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/programmirovanie/ > Программирование </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/meropriiatiia/ > мероприятия </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/masshtabiruemost/ > Масштабируемость </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/apache/ > Apache </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/informatsionnye-tekhnologii/ > информационные технологии </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/memcached/ > Memcached </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/internet/ > интернет </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/google/ > Google </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/mysql/ > MySQL </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/c/ > C++ </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/arkhitektura/ > архитектура </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/hbase/ > HBase </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/tekhnologiia/ > технология </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/python/ > Python </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/javascript/ > JavaScript </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/oop/ > ООП </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/nginx/ > nginx </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/facebook/ > Facebook </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/highload/ > highload </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/php/ > PHP </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/razrabotka/ > разработка </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/hadoop/ > Hadoop </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/online/ > online </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/linux/ > Linux </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/java/ > Java </a></span>&ensp;</div></div></div></div><div class=footer-copyright><div class=container> © Insight IT, 2008-2015 <a class="license right tooltipped" rel="license nofollow" target=_blank href=http://creativecommons.org/licenses/by-nc-nd/4.0/ data-position=top data-delay=50 data-tooltip="Все материалы опубликованы под лицензией Creative Commons Attribution-NonCommercial-NoDerivatives 4.0"><img alt="Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License" src=https://www.insight-it.ru/theme/images/license.png></a></div></div></footer><script src=//code.jquery.com/jquery-2.1.1.min.js></script><script src=https://www.insight-it.ru/theme/js/main.js?b5bb290d></script><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js ','ga');
ga('create', 'UA-3403373-1', 'auto');
ga('send', 'pageview');
</script><script type=text/javascript>(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter30650472 = new Ya.Metrika({id:30650472, webvisor:true, clickmap:true, trackLinks:true, accurateTrackBounce:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src=//mc.yandex.ru/watch/30650472 style="position:absolute; left:-9999px;" alt></div></noscript></body></html>