<!DOCTYPE html>
<html lang=ru xmlns=http://www.w3.org/1999/xhtml xmlns:og=http://ogp.me/ns# xmlns:fb=https://www.facebook.com/2008/fbml><head><meta http-equiv=Content-Type content="text/html; charset=UTF-8"><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=msapplication-tap-highlight content=no><title>Архитектура Facebook</title><link href="//fonts.googleapis.com/css?family=Open+Sans&amp;subset=latin,cyrillic" rel=stylesheet type=text/css><link href="//fonts.googleapis.com/css?family=PT+Sans&amp;subset=latin,cyrillic" rel=stylesheet type=text/css><link rel=stylesheet href=https://www.insight-it.ru/theme/css/main.css?969f431c><link href=https://www.insight-it.rufeed/index.xml type=application/rss+xml rel=alternate title="Insight IT RSS Feed"><link rel=canonical href=https://www.insight-it.ru/highload/2010/arkhitektura-facebook/ ><meta property=og:url content=https://www.insight-it.ru/highload/2010/arkhitektura-facebook/ ><meta property=og:title content="Архитектура Facebook"><meta property=og:type content=article><meta name=description content="На сегодняшний день Facebook является пожалуй самым обсуждаемым интернет-проектом во всем мире. Не смотря на довольно ..."><meta property=og:description content="На сегодняшний день Facebook является пожалуй самым обсуждаемым интернет-проектом во всем мире. Не смотря на довольно ..."><meta name=keywords content="CDN,Facebook,featured,HipHop,Linux,Memcached,MySQL,ODS,PHP,Scribe,Thrift,Архитектура Facebook"><meta name=author content="Иван Блинков"><meta property=og:site_name content="Insight IT"><meta property=og:locale content=ru_RU></head><body><header><div class=container><a href=# data-activates=nav-mobile class="button-collapse top-nav waves-effect waves-light circle"><i class=icon-menu></i></a></div><ul id=nav-mobile class="side-nav fixed"><li class=logo><a id=logo-container href=https://www.insight-it.ru/ class=brand-logo><h4>Insight IT</h4></a></li><li class=bold><a href=https://www.insight-it.ru/highload/ > Высокие нагрузки </a></li><li class=bold><a href=https://www.insight-it.ru/interactive/ > Интерактивные сайты </a></li><li class=no-padding><ul class="collapsible collapsible-accordion"><li class=bold><a class="collapsible-header waves-effect waves-red"> Рубрики </a><div class=collapsible-body><ul><li><a href=https://www.insight-it.ru/category/linux/ > Linux </a></li><li><a href=https://www.insight-it.ru/category/python/ > Python </a></li><li><a href=https://www.insight-it.ru/category/erlang/ > Erlang </a></li><li><a href=https://www.insight-it.ru/category/frontend/ > Frontend </a></li><li><a href=https://www.insight-it.ru/category/storage/ > Хранение данных </a></li><li><a href=https://www.insight-it.ru/category/theory/ > Теория </a></li><li><a href=https://www.insight-it.ru/category/event/ > Мероприятия </a></li><li><a href=https://www.insight-it.ru/category/misc/ > Разное </a></li><li><a href=https://www.insight-it.ru/category/index/ > Все рубрики </a></li></ul></div></li></ul></li><li class=no-padding><ul class="collapsible collapsible-accordion"><li class=bold><a class="collapsible-header waves-effect waves-red"> Страницы </a><div class=collapsible-body><ul><li><a href=https://www.insight-it.ru/blog/ > Блог </a></li><li><a href=https://www.insight-it.ru/about/ > О сайте </a></li><li><a href=https://www.insight-it.ru/author/ > Об авторе </a></li><li><a href=https://www.insight-it.ru/consulting/ > Консультации </a></li><li><a href=https://www.insight-it.ru/contact/ > Контакты </a></li><li><a href=https://www.insight-it.ru/resume/ > Резюме </a></li><li><a href=https://www.insight-it.ru/search/ > Поиск по сайту </a></li></ul></div></li></ul></li></ul></header><main><nav class=top-nav><div class=container><div class=nav-wrapper><ul id=nav-mobile class="right hide-on-med-and-down"><li class><a href=/blog/ >Блог</a></li><li class><a href=/about/ >О&nbsp;сайте</a></li><li class><a href=/author/ >Об&nbsp;авторе</a></li></ul><h1><a class=page-title> Архитектура Facebook </a></h1></div></div></nav><div class=container><div class=row><div class="col s12 m9 l10"><div class="materialdesign section scrollspy"><section id=content class=body><article class=entry-content><p><img alt="Facebook Logo" class=left src=https://www.insight-it.ru/images/facebook_logo.jpg title="Facebook Logo"> На сегодняшний день <a href=https://www.insight-it.ru/goto/fbae133c/ rel=nofollow target=_blank title=https://www.facebook.com>Facebook</a> является пожалуй самым обсуждаемым интернет-проектом во всем мире. Не смотря на довольно низкий уровень проникновения Facebook в России, темпы захвата аудитории этим проектом мягко говоря поражают. Как же им удается управляться с таким огромным социальным графом и удовлетворять потребности в общении невероятно большого количества людей по всему миру?</p><h2 id=platforma>Платформа</h2><ul><li><a href=/tag/linux/ >Linux</a> - операционная система</li><li><a href=/tag/php/ >PHP</a> с <a href=/tag/hiphop/ >HipHop</a> - код на PHP компилируется в C++</li><li><a href=/tag/memcached/ >memcached</a> - агрессивное кэширование объектов</li><li><a href=/tag/mysql/ >MySQL</a> - используется как хранилище пар ключ-значение, никаких join'ов</li><li><a href=/tag/thrift/ >Thrift</a> - интерфейс взаимодействия между сервисами, написанными на разных языках программирования</li><li><a href=/tag/scribe/ >Scribe</a> - универсальная система сбора и агрегации данных с рабочих серверов</li></ul><h2 id=statistika>Статистика</h2><ul><li>Более 500 миллионов активных пользователей (месячная аудитория)</li><li>Более миллиарда социальных связей</li><li>Более 200 миллиардов просмотров страниц в месяц</li><li>Более 4 триллионов действий попадает в новостные ленты каждый день</li><li>Более 150 миллионов обращений к кэшу в секунду; 2 триллиона объектов в кэше</li><li>Более 8 миллиардов минут провели пользователи на Facebook'е ежедневно</li><li>Более 3 миллиардов фотографий загружается каждый месяц, до 1.2 миллиона фотографий в секунду</li><li>20 миллиардов фотографий в 4 разрешениях = 80 миллиардов фотографий, их бы хватило чтобы покрыть поверхность земли в 10 слоев; это больше, чем на всех других фото-ресурсах в месте взятых</li><li>О более чем 5 миллиардах единиц контента рассказывается друзьям еженедельно</li><li>Более миллиарда сообщений в чате каждый день</li><li>Более ста миллионов поисковых запросов в день</li><li>Более 250 приложений и 80 тысяч сторонних ресурсов на платформе Facebook Connect</li><li>Более 400 тысяч разработчиков сторонних приложений</li><li>Менее 500 разработчиков и системных администраторов в штате</li><li>Более миллиона активных пользователей на одного инженера</li><li>Десятки тысяч серверов, десятки гигабит трафика</li></ul><h2 id=arkhitektura>Архитектура</h2><h3 id=obshchie-printsipy>Общие принципы</h3><ul><li>Балансировщик нагрузки выбирает веб-сервер для обработки запроса</li><li>PHP-код в веб-сервере подготавливает HTML, пользуясь данными из различных источников:<ul><li>MySQL</li><li>memcached</li><li>Специализированные сервисы</li></ul></li><li>Если взглянуть с другой стороны, то получим трехуровневую архитектуру:<ul><li>Вер-приложение</li><li>Распределенный индекс</li><li>Постоянное хранилище</li></ul></li><li>Использование открытых технологий там, где это возможно</li><li>Поиск возможностей оптимизации используемых продуктов</li><li>Философия Unix:<ul><li>Старайтесь делать каждый компонент системы простым и производительным</li><li>Комбинируйте компоненты для решения задач</li><li>Концентрируйте внимание на хорошо обозначенных точках взаимодействия</li></ul></li><li>Все усилия направлены на масштабируемость</li><li>Попытки минимизации количества точек отказа</li><li>Простота, простота, простота!</li></ul><h3 id=php>PHP</h3><p><strong>Почему PHP?</strong></p><ul><li>Во многом "так исторически сложилось"</li><li>Хорошо подходит для веб-разработки</li><li>Легок в изучении: небольшой набор выражений и языковых конструкций</li><li>Легок в написании: нестрогая типизация и универсальный "массив"</li><li>Легок в чтении: синтаксис похож на C++ и Java</li><li>Прост в дебаггинге: нет необходимости в перекомпиляции</li><li>Большой ассортимент библиотек, актуальных для веб-проектов</li><li>Подходит для процесса разработки с короткими итерациями</li><li>Активное сообщество разработчиков по всему миру</li><li>Динамическая типизация, интерпретируемый язык для скриптов</li></ul><p><strong>Как оказалось на самом деле?</strong></p><ul><li>Высокий расход оперативной памяти и вычислительных ресурсов</li><li>Сложно работать, когда объем исходного кода очень велик: слабая типизация и ограниченные возможности для статичного анализа и оптимизации кода</li><li>Не особо оптимизирован для использования в крупных проектах</li><li>Линейный рост издержек при подключении файлов с исходным кодом</li><li>Механизм разработки расширений не очень удобен</li></ul><p><strong>Доработки:</strong></p><ul><li>Оптимизация байт-кода</li><li>Улучшения в APC (ленивая загрузка, оптимизация блокировок, "подогрев" кэша)</li><li>Свои расширения (клиент memcache, формат сериализации, логи, статистика, мониторинг, механизм асинхронной обработки событий)</li><li><strong><a href=https://www.insight-it.ru/goto/169aa287/ rel=nofollow target=_blank title=http://github.com/facebook/hiphop-php>HipHop</a></strong> - трансформатор исходных кодов:<ul><li>Разработчики пишут на PHP, который конвертируется в оптимизированный C++</li><li>Статический анализ, определение типов данных, генерация кода, и.т.д.</li><li>Облегчает разработку расширений</li><li>Существенно сокращает расходы оперативной памяти и вычислительных ресурсов</li><li>У команды из трех программистов ушло полтора года на разработку, переписаны большая часть интерпретатора и многие расширения языка</li><li>Опубликован под opensource лицензией в начале года, нет необходимости проходить этот же путь с нуля</li></ul></li></ul><h3 id=mysql>MySQL</h3><p><strong>Как используется MySQL?</strong></p><ul><li>Используется как хранилище пар ключ-значение</li><li>Большое количество логических узлов распределено между физическими машинами</li><li>Балансировка нагрузке на уровне физических серверов</li><li>Репликация для распределения операций чтения <strong>не</strong> используется</li><li>Большинство запросов касаются самой свежей информации: оптимизация таблиц для доступа к новым данным, архивация старых записей</li><li>В целом быстро и надежно</li></ul><p><strong>Как оказалось на самом деле?</strong></p><ul><li>Логическая миграция данных <em>очень</em> сложна</li><li>Создавать большое количество логических баз данных и перераспределять их между физическими узлами, балансируя таким образом нагрузку, намного удобнее</li><li>Никаких join'ов на рабочих серверах баз данных</li><li>Намного проще наращивать вычислительные мощности на веб-серверах, чем на серверах баз данных</li><li>Схемы, основанные на структуре данных, делают программистов счастливыми и создают большую головную боль администраторам</li><li>Никогда не храните не-статичные данные в централизованное базе данных</li></ul><p><strong>Доработки:</strong></p><ul><li>Практически никаких модификаций исходного кода MySQL</li><li>Своя схема партиционирования с глобально-уникальными идентификаторами</li><li>Своя схема архивирования, основанная на частоте доступа к данным относительно каждого пользователя</li><li>Расширенный движок запросов для репликации между датацентрами и поддержания консистенции кеша</li><li>Библиотеки для доступа к данным на основе графа:<ul><li>Объекты (вершины графа) с ограниченными типами данных (целое число, строка ограниченно длины, текст)</li><li>Реплицированные связи (ребра графа)</li><li>Аналоги распределенных внешних ключей (foreign keys)</li><li>Большинство данных распределено случайно</li></ul></li></ul><h3 id=memcache>Memcache</h3><p><strong>Как используется memcached?</strong></p><ul><li>Высокопроизводительная распределенная хэш-таблица</li><li>Содержит "горячие" данные из MySQL</li><li>Снижает нагрузку на уровень баз данных</li><li>Основная форма кэширования</li><li>Используется более 25TB памяти на нескольких тысячах серверов</li><li>Среднее время отклика менее 250 микро-секунд</li><li>Кэшируются сериализованные структуры данных PHP</li><li>Отсутствие автоматического механизма проверки консистенции данных между memcached и MySQL - приходится делать это на уровне программного кода</li><li>Множество multi-get запросов для получения данных на другом конце ребер графа</li><li>Ограниченная модель данных, неэффективен для маленьких объектов</li></ul><p><strong>Доработки:</strong></p><ul><li>Порт на 64-битную архитектуру</li><li>Более эффективная сериализация</li><li>Многопоточность</li><li>Улучшенный протокол</li><li>Компрессия</li><li>Проксирование запросов</li><li>Доступ к memcache через UDP:<ul><li>уменьшает расход памяти благодаря отсутствию тысяч буферов TCP соединений</li><li>управление ходом исполнения приложение (оптимизация для multi-get)</li></ul></li><li>Статистика о работе потоков по запросу - уменьшает блокировки</li><li>Ряд изменений в ядре Linux для оптимизации работы memcache:<ul><li>распределение управления сетевыми прерывания по всем ядрам</li><li>оппортунистический опрос сетевых интерфейсов</li></ul></li><li>После вышеперечисленных модификаций memcached способен выполнять до 250 тысяч операций в секунду, по сравнению со стандартными 30-40 тысячами без данных изменений</li></ul><h3 id=thrift>Thrift</h3><p><strong>Что это?</strong></p><ul><li>Легкий механизм построения приложений с использованием нескольких языков программирования</li><li>Высокая цель: предоставить механизм прозрачного взаимодействия между языками программирования.</li><li>Предоставляет язык описания интерфейсов, статический генератор кода</li><li>Поддерживаемые языки: <a href=/tag/c/ >C++</a>, <a href=/tag/php/ >PHP</a>, <a href=/tag/python/ >Python</a>, <a href=/tag/java/ >Java</a>, <a href=/tag/ruby/ >Ruby</a>, <a href=/tag/erlang/ >Erlang</a>, <a href=/tag/perl/ >Perl</a>, <a href=/tag/haskell/ >Haskell</a> и многие другие</li><li>Транспорты: простой интерфейс для ввода-вывода (сокеты, файлы, буферы в памяти)</li><li>Протоколы: стандарты сериализации (бинарный, JSON)</li><li>Серверы: неблокирующие, асинхронные, как однопоточные, так и многопоточные</li></ul><p><strong>Почему именно Thrift?</strong></p><ul><li>Альтернативные технологии: SOAP, CORBA, COM, Pillar, Protocol Buffers - но у всех есть свои существенные недостатки, что вынудило Facebook создать свою технологию</li><li>Он быстрый, очень быстрый</li><li>Меньше рабочего времени тратится каждым разработчиком на сетевые интерфейсы и протоколы</li><li>Разделение труда: работа над высокопроизводительными серверами ведется отдельно от работы над приложениями</li><li>Общий инструментарий, знакомый всем разработчикам</li></ul><h3 id=scribe>Scribe</h3><p><strong>Что это?</strong></p><ul><li>Масштабированный распределенный механизм ведения логов</li><li>Перемещает данные с серверов в центральный репозиторий</li><li>Широкая сфера применения:<ul><li>Логи поисковых запросов</li><li>Публикации в новостных лентах</li><li>Данные по A/B тестированиям</li></ul></li><li>Более надежен, чем традиционные системы логгирования, но недостаточно надежен для транзакций баз данных</li><li>Простая модель данных</li><li>Построен на основе Thrift</li></ul><h3 id=khranenie-fotografii>Хранение фотографий</h3><p><strong>Сначала сделали это просто:</strong></p><ul><li>Загрузка на сервер: приложение принимает изображение, создает миниатюры в нужных разрешениях, сохраняет в NFS</li><li>Загрузка с сервера: изображения отдаются из NFS через HTTP</li><li>NFS построена на коммерческих продуктах</li><li>Это было необходимо, чтобы сначала проверить, что продукт востребован пользователями и они правда будут активно загружать фотографии</li><li>На самом деле оказалось, что:<ul><li>Файловые системы непригодны для работы с большим количеством небольших файлов</li><li>Метаданные не помещаются в оперативную память, что приводит к дополнительным обращениям к дисковой подсистеме</li><li>Ограничивающим фактором является ввод-вывод, а не плотность хранения</li></ul></li></ul><p><strong>Потом начали оптимизировать:</strong></p><ul><li>Кэширование более часто используемых миниатюр изображений в памяти на оригинальных серверах для масштабируемости, надежности и производительности</li><li>Распределение их по <a href=/tag/cdn/ >CDN</a> для уменьшения сетевых задержек</li><li>Возможно сделать еще лучше:<ul><li>Хранение изображений в больших бинарных файлах (blob)</li><li>Сервис, отвечающий за фотографии имеет информацию о том, в каком файле и с каким отступом от начала расположена каждая фотография (по ее идентификатору)</li><li>Этот сервис в Facebook называется Haystack и он оказался в 10 раз эффективнее "простого" подхода и в 3 раза эффективнее "оптимизированного"</li></ul></li></ul><h3 id=drugie-servisy>Другие сервисы</h3><ul><li><strong>SMC</strong>: консоль управления сервисами - централизованная конфигурация, определение на какой физической машине работает логический сервис</li><li><strong>ODS</strong>:&nbsp;инструмент для визуализации изменений любых статистических данных, имеющихся в системе; удобен для мониторинга и оповещений</li><li><strong>Gatekeeper:</strong> разделение развертывания и запуска, A/B тестирования, таргетированный запуск, постепенный запуск</li><li>И еще около 50 других сервисов...</li></ul><h2 id=kak-eto-rabotaet-vse-vmeste_1>Как это работает все вместе?</h2><h3 id=novye-albomy-druzei>Новые альбомы друзей</h3><p><img alt="Facebook Screenshot" class=responsive-img src=https://www.insight-it.ru/images/facebook_screenshot.jpg title=Facebook></p><ol><li>Получаем профиль по идентификатору пользователя (скорее всего из кэша, но потенциально возможно обращение к базе данных)</li><li>Получаем список друзей (опять же на основе идентификатора пользователя из кэша или из базы данных в случае промаха)</li><li>Параллельно запрашиваем идентификаторы последних 10 альбомов для каждого из друзей (multi-get, каждый промах мимо кэша индивидуально вытаскивается из MySQL)</li><li>Параллельно получаем данные о всех альбомах (на основе идентификаторов альбомов из предыдущего шага)</li><li>Все данные получены, выполняем логику отрисовки конкретной страницы на PHP</li><li>Отправляем HTML в браузер, пользователь счастлив :)</li></ol><h3 id=novostnaia-lenta>Новостная лента</h3><p><img alt="News Feed Screenshot" class=responsive-img src=https://www.insight-it.ru/images/facebook_screenshot_2.jpg title="News Feed"></p><p><img alt="News Feed Scheme" class=responsive-img src=https://www.insight-it.ru/images/facebook_screenshot_3.jpg title="News Feed"></p><h3 id=poisk>Поиск</h3><p><img alt="Search Screenshot" class=responsive-img src=https://www.insight-it.ru/images/facebook_screenshot_4.jpg title=Search></p><p><img alt="Search Scheme" class=responsive-img src=https://www.insight-it.ru/images/facebook_screenshot_5.jpg title=Search></p><h2 id=podvodim-itogi_1>Подводим итоги</h2><p>LAMP не идеален</p><ul><li>PHP+MySQL+Memcache решает большинство задач, но не может решить совсем все:<ul><li>PHP не может хранить состояния</li><li>PHP не самый производительный язык</li><li>Все данные находятся удаленно</li></ul></li><li>Facebook разрабатывает собственные внутренние сервисы, чтобы:<ul><li>Располагать исполняемый код ближе к данным</li><li>Скомпилированное окружение более эффективно</li><li>Некоторая функциональность присутствует только в других языках программирования</li></ul></li><li>Философия сервисов:<ul><li>Создание сервисов только при необходимости (минимизация издержек по развертке, поддержке и ведению отдельной кодовой базы; потенциальная дополнительная точка сбоя)</li><li>Создание общего набора инструментов для создания сервисов (Thrift, Scribe, ODS, средства мониторинга и уведомлений)</li><li><em>Использование правильных языка программирования, библиотек и инструментов для решения задачи</em></li></ul></li><li>Возвращение инноваций общественности - важный аспект разработки в Facebook:<ul><li>Опубликованные свои проекты:<ul><li>Thrift</li><li>Scribe</li><li>Tornado</li><li>Cassandra</li><li>Varnish</li><li>Hive</li><li>xhprof</li></ul></li><li>Доработки популярных решений:<ul><li>PHP</li><li>MySQL</li><li>memcached</li></ul></li><li>Информация о взаимодействии Facebook с opensource-сообществом, этих и других проектах расположена на <a href=https://www.insight-it.ru/goto/535d8e6b/ rel=nofollow target=_blank title=http://developers.facebook.com/opensource/ >странице, посвященной opensource</a>.</li></ul></li><li>Ключевые моменты культуры разработки в Facebook:<ul><li><strong>Двигайся быстро</strong> и не бойся ломать некоторые вещи</li><li><strong>Большое влияние</strong> маленьких команд</li><li><strong>Будь откровенным</strong> и инновационным</li></ul></li></ul><h2 id=istochniki-informatsii>Источники информации</h2><p>Данная статья не является переводом готовой статьи, в качестве источников информации послужили записи выступлений сотрудников Facebook на конференциях:</p><ul><li><a href=https://www.insight-it.ru/goto/4c672c94/ rel=nofollow target=_blank title=http://www.infoq.com/presentations/Facebook-Software-Stack>Facebook Architecture: Science and the Social Graph</a></li><li><a href=https://www.insight-it.ru/goto/2ccd1899/ rel=nofollow target=_blank title=http://www.infoq.com/presentations/Facebook-Moving-Fast-at-Scale>Facebook: Moving Fast at Scale</a></li><li><a href=https://www.insight-it.ru/goto/3867625a/ rel=nofollow target=_blank title=http://www.infoq.com/presentations/Scale-at-Facebook>Scale at Facebook</a></li></ul><p>Очень рекомендую посмотреть материалы в оригинале, так как естественно я осветил в статье далеко не все, да и неточности какие-либо неисключены. Помимо этого возможно многим будет интересно мероприятие <a href=https://www.insight-it.ru/goto/ff11ad2b/ rel=nofollow target=_blank title=http://styleru.timepad.ru/event/3571>"Facebook: how we scaled to 500 000 000 users "</a>, где Robert Johnson выступает 22 октября в Москве. Еще он числится в списке докладчиков <a href=https://www.insight-it.ru/goto/727c9436/ rel=nofollow target=_blank title=http://www.highload.ru>Highload++</a> с аналогичным выступлением. Дополнительную информацию можно почерпнуть в <a href=https://www.insight-it.ru/goto/f38bc794/ rel=nofollow target=_blank title=http://facebook.com/eblog>блоге инженеров Facebook</a>.</p><p><strong>UPD:</strong> Обновил некоторые моменты после посещения вышеупомянутого выступления Роберта.</p><p>И по традиции напоминаю, что так как я пишу довольно редко - читать мой блог намного удобнее по <a href=/feed/ >RSS</a>. Спасибо за внимание :)</p><div class=sharrre-wrapper><div class=twitter data-url=https://www.insight-it.ru/highload/2010/arkhitektura-facebook/ data-text="Архитектура Facebook" data-title=Tweet></div><div class=facebook data-url=https://www.insight-it.ru/highload/2010/arkhitektura-facebook/ data-text="Архитектура Facebook" data-title=Like></div><div class=linkedin data-url=https://www.insight-it.ru/highload/2010/arkhitektura-facebook/ data-text="Архитектура Facebook" data-title="In Share" ></div></div><div class="card-panel light-blue darken-2 light-blue-text text-lighten-4"><span class=published title=2010-10-20T13:02:00+04:00>20 октября 2010</span>&nbsp;|&nbsp;<span class="vcard author"><a class="url fn light-blue-text text-lighten-4" href=https://www.insight-it.ru/author/ > Иван Блинков </a></span>&nbsp;|&nbsp;<a href=https://www.insight-it.ru/category/highload/ class="light-blue-text text-lighten-4" > Высокие нагрузки </a></div><div class=taglist class=row><a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/cdn/ > CDN </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/facebook/ > Facebook </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/featured/ > featured </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/hiphop/ > HipHop </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/linux/ > Linux </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/memcached/ > Memcached </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/mysql/ > MySQL </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/ods/ > ODS </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/php/ > PHP </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/scribe/ > Scribe </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/thrift/ > Thrift </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/arkhitektura-facebook/ > Архитектура Facebook </a>&ensp;</div></footer></article></section></div><div class=after><div id=comments></div><script type=text/javascript>
        var disqus_shortname = 'insight-it';
        var disqus_identifier = '579 http://www.insight-it.ru/?p=579';
        var disqus_url = 'https://www.insight-it.ru/highload/2010/arkhitektura-facebook/';
        var disqus_domain = 'disqus.com';
        var disqus_title = 'Архитектура Facebook';
        var disqus_container_id = 'comments';
        (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//insight-it.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script></div></div><div class="col hide-on-small-only m3 l2"><div class=card><a href=https://www.insight-it.ru/author><div class="card-image tooltipped" data-position=top data-delay=50 data-tooltip="Автор Insight IT"><img src=https://www.insight-it.ru/images/avatar.jpeg><span class=card-title>Иван Блинков</span></div></a></div><div class=toc-wrapper><div style="height: 1px;"><ul class="section table-of-contents"><li><a href=# title="Архитектура Facebook">Архитектура Facebook</a><li><a href=#platforma title=Платформа>Платформа</a></li><li><a href=#statistika title=Статистика>Статистика</a></li><li><a href=#arkhitektura title=Архитектура>Архитектура</a><li><a href=#obshchie-printsipy title="Общие принципы">Общие принципы</a></li><li><a href=#php title=PHP>PHP</a></li><li><a href=#mysql title=MySQL>MySQL</a></li><li><a href=#memcache title=Memcache>Memcache</a></li><li><a href=#thrift title=Thrift>Thrift</a></li><li><a href=#scribe title=Scribe>Scribe</a></li><li><a href=#khranenie-fotografii title="Хранение фотографий">Хранение фотографий</a></li><li><a href=#drugie-servisy title="Другие сервисы">Другие сервисы</a></li></li><li><a href=#kak-eto-rabotaet-vse-vmeste_1 title="Как это работает все вместе?">Как это работает все вместе?</a><li><a href=#novye-albomy-druzei title="Новые альбомы друзей">Новые альбомы друзей</a></li><li><a href=#novostnaia-lenta title="Новостная лента">Новостная лента</a></li><li><a href=#poisk title=Поиск>Поиск</a></li></li><li><a href=#podvodim-itogi_1 title="Подводим итоги">Подводим итоги</a></li><li><a href=#istochniki-informatsii title="Источники информации">Источники информации</a></li></li></ul></div></div></div></div></div></main><footer class=page-footer><div id=footer class=container><div class=row><div class="col m4 s12"><h5 class=white-text>Иван Блинков</h5><ul><li><a href=mailto:insight-it@blinkov.ru rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-mail white-text"></i> insight-it@blinkov.ru </span></a></li><li><a href=https://www.linkedin.com/in/ivanblinkov rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-linkedin light-blue-text text-darken-3"></i> LinkedIn </span></a></li><li><a href=https://twitter.com/blinkov rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-twitter cyan-text text-accent-2"></i> @blinkov </span></a></li><li><a href="http://plus.google.com/102882395551389724078?rel=author" rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-gplus red-text"></i> Google </span></a></li><li><a href="http://plus.google.com/102882395551389724078?rel=author" rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-facebook blue-text text-darken-3"></i> Facebook </span></a></li><li><a href=https://www.insight-it.ru/feed/ rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-rss orange-text"></i> Подписаться по RSS </span></a></li></ul><a href=//feeds.feedburner.com/insight-it/feed target=_blank rel="external nofollow"><img src="//feeds.feedburner.com/~fc/insight-it/feed?bg=b3e5fc&amp;fg=222222&amp;anim=1" height=26 width=88></a>&nbsp;<a href=//twitter.com/blinkov target=_blank rel="external nofollow"><img src=//button.twittercounter.com/animated/blinkov/222222/b3e5fc width=88 height=26></a></div><div class="col m4 s12"><h5 class=white-text>Рубрики</h5><ul><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/highload/ > Высокие нагрузки </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/interactive/ > Интерактивные сайты </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/linux/ > Linux </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/python/ > Python </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/erlang/ > Erlang </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/storage/ > Хранение данных </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/frontend/ > Frontend </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/theory/ > Теория </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/event/ > Мероприятия </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/misc/ > Разное </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/php/ > PHP </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/security/ > Безопасность </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/vacancy/ > Вакансии </a></li></ul><h5 class=white-text>Навигация</h5><ul><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/blog/ >Блог</a></li><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/about/ >О&nbsp;сайте</a></li><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/author/ >Об&nbsp;авторе</a></li></ul></div><div class="col m4 s12"><h5 class="white-text center-align">Теги</h5><div class="tagcloud taglist"><span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/razrabotka/ > разработка </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/masshtabiruemost/ > Масштабируемость </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/javascript/ > JavaScript </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/informatsionnye-tekhnologii/ > информационные технологии </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/hadoop/ > Hadoop </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/apache/ > Apache </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/mysql/ > MySQL </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/linux/ > Linux </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/internet/ > интернет </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/meropriiatiia/ > мероприятия </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/highload/ > highload </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/tekhnologiia/ > технология </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/oop/ > ООП </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/google/ > Google </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/arkhitektura/ > архитектура </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/online/ > online </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/memcached/ > Memcached </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/hbase/ > HBase </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/python/ > Python </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/java/ > Java </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/php/ > PHP </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/c/ > C++ </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/nginx/ > nginx </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/programmirovanie/ > Программирование </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/facebook/ > Facebook </a></span>&ensp;</div></div></div></div><div class=footer-copyright><div class=container> © Insight IT, 2008-2015 <a class="license right tooltipped" rel="license nofollow" target=_blank href=http://creativecommons.org/licenses/by-nc-nd/4.0/ data-position=left data-delay=50 data-tooltip="Все материалы опубликованы под лицензией Creative Commons Attribution-NonCommercial-NoDerivatives 4.0"><img alt="Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License" src=https://www.insight-it.ru/theme/images/license.png></a></div></div></footer><script src=//code.jquery.com/jquery-2.1.1.min.js></script><script src=https://www.insight-it.ru/theme/js/main.js?b5bb290d></script><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js ','ga');
ga('create', 'UA-3403373-1', 'auto');
ga('send', 'pageview');
</script></body></html>