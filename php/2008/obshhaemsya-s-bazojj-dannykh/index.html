<!DOCTYPE html>
<html lang=ru xmlns=http://www.w3.org/1999/xhtml xmlns:og=http://ogp.me/ns# xmlns:fb=https://www.facebook.com/2008/fbml><head><meta http-equiv=Content-Type content="text/html; charset=UTF-8"><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=msapplication-tap-highlight content=no><title>Общаемся с базой данных</title><link href="//fonts.googleapis.com/css?family=Open+Sans&amp;subset=latin,cyrillic" rel=stylesheet type=text/css><link href="//fonts.googleapis.com/css?family=PT+Sans&amp;subset=latin,cyrillic" rel=stylesheet type=text/css><link rel=stylesheet href=https://www.insight-it.ru/theme/css/main.css?5e55de6b><link rel=canonical href=https://www.insight-it.ru/php/2008/obshhaemsya-s-bazojj-dannykh/ ><meta property=og:url content=https://www.insight-it.ru/php/2008/obshhaemsya-s-bazojj-dannykh/ ><meta property=og:title content="Общаемся с базой данных"><meta property=og:type content=article><meta name=description content="На этот раз хочется обсудить такой одновременно важный и несложный момент в реализации работы любого интернет-проекта, ..."><meta property=og:description content="На этот раз хочется обсудить такой одновременно важный и несложный момент в реализации работы любого интернет-проекта, ..."><meta name=keywords content="MySQL,PHP,PostgreSQL,SQL,БД,интерфейс,кодинг,ООП,СУБД,технология,хранение данных"><meta name=author content="Иван Блинков"><meta property=og:site_name content="Insight IT"><meta property=og:locale content=ru_RU><link href=https://www.insight-it.ru/feed/index.xml type=application/rss+xml rel=alternate title="Insight IT RSS Feed"></head><body><header><div class=container><a href=# data-activates=nav-mobile class="button-collapse top-nav waves-effect waves-light circle"><i class=icon-menu></i></a></div><ul id=nav-mobile class="side-nav fixed"><li class=logo><a id=logo-container href=https://www.insight-it.ru/ class=brand-logo><h4>Insight IT</h4></a></li><li class=bold><a href=https://www.insight-it.ru/highload/ > Высокие нагрузки </a></li><li class=bold><a href=https://www.insight-it.ru/interactive/ > Интерактивные сайты </a></li><li class=no-padding><ul class="collapsible collapsible-accordion"><li class=bold><a class="collapsible-header waves-effect waves-red"> Рубрики </a><div class=collapsible-body><ul><li><a href=https://www.insight-it.ru/category/linux/ > Linux </a></li><li><a href=https://www.insight-it.ru/category/python/ > Python </a></li><li><a href=https://www.insight-it.ru/category/erlang/ > Erlang </a></li><li><a href=https://www.insight-it.ru/category/frontend/ > Frontend </a></li><li><a href=https://www.insight-it.ru/category/storage/ > Хранение данных </a></li><li><a href=https://www.insight-it.ru/category/theory/ > Теория </a></li><li><a href=https://www.insight-it.ru/category/event/ > Мероприятия </a></li><li><a href=https://www.insight-it.ru/category/misc/ > Разное </a></li><li><a href=https://www.insight-it.ru/category/index/ > Все рубрики </a></li></ul></div></li></ul></li><li class=no-padding><ul class="collapsible collapsible-accordion"><li class=bold><a class="collapsible-header waves-effect waves-red"> Страницы </a><div class=collapsible-body><ul><li><a href=https://www.insight-it.ru/blog/ > Блог </a></li><li><a href=https://www.insight-it.ru/about/ > О сайте </a></li><li><a href=https://www.insight-it.ru/author/ > Об авторе </a></li><li><a href=https://www.insight-it.ru/consulting/ > Консультации </a></li><li><a href=https://www.insight-it.ru/contact/ > Контакты </a></li><li><a href=https://www.insight-it.ru/resume/ > Резюме </a></li><li><a href=https://www.insight-it.ru/search/ > Поиск по сайту </a></li></ul></div></li></ul></li></ul></header><main><nav class=top-nav><div class=container><div class=nav-wrapper><ul id=nav-mobile class="right hide-on-med-and-down"><li class><a href=/blog/ >Блог</a></li><li class><a href=/about/ >О&nbsp;сайте</a></li><li class><a href=/author/ >Об&nbsp;авторе</a></li></ul><h1><a class=page-title> Общаемся с базой данных </a></h1></div></div></nav><div class=container><div class=row><div class="col s12 m9 l10"><div class="materialdesign section scrollspy"><section id=content class=body><article class=entry-content><p>На этот раз хочется обсудить такой одновременно важный и несложный момент в реализации работы любого интернет-проекта, как координации работы Ваших скриптов с СУБД.</p><p>Если подойти к этому вопросу "в лоб", то код станет очень неудобен как для понимания, так и для использования: код станет переполнен различными функциями соединения с БД, отправки запросов, преобразования результатов запросов в массивы PHP, подсчета строк, которые затронул запрос, а также многие и многие другие.</p><p>Для желающих минимизировать подобного рода издержки в процессе написания кода, хочу предложить один из, на мой взгляд, самых эффективных способов решения этой проблемы.</p><p>Этим способом будет являться написание класса, реализующего интерфейс между СУБД и PHP-скриптами. Для начала стоит определиться с ассортиментом функций, которые будет призван выполнять наш класс:</p><ul><li><em>установка соединения</em>, а также проверка успешности выполнения этого действия;</li><li><em>отправка запросов</em>, как заданных извне так и, возможно, из какого-либо ассортимента заранее написанных запросов;</li><li><em>обработка результатов запросов</em>, не ограничивающаяся одним SELECT, должны быть предоставлены методы обработки результатов любых видов запросов (или хотябы большинства).</li></ul><p>Вполне очевидным является тот факт, что методы этого класса будут использоваться практически повсеместно в большинстве проектов. Вследствии чего становится нецелесообразным создание объекта нашего класса и передача его по всем функциям и методам всех скриптов, в таких случае намного предпочтительнее делать владельцем методов и переменных сам класс, а не экземпляр класса, с помощью ключевого слова <strong>static</strong>. Это позволит пользоваться услугами нашего класса из любого места кода. Приступим-с собственно к кодингу, начать стоит с заготовки пустого класса:</p><div class=highlight><pre><span class=cp>&lt;?php</span>
<span class=k>class</span> <span class=nc>SQL</span>
<span class=p>{</span>
<span class=p>}</span>
<span class=cp>?&gt;</span><span class=x></span>
</pre></div><p>В зависимости от предпочитаемой Вами СУБД набор конкретных функций, используемых в реализации нашего класса, будет вариироваться. В большинстве случаев предпочитаю пользоваться PostgreSQL, на это причин у меня несколько, но это тема для отдельного разговора. Благодаря этому факту приводимый в качестве примера код будет использовать функции для работы именно с этой СУБД. Для поклонников же других этот систем вопрос в подавляющем большинстве случаев заключается лишь в замене этих функций на аналогичные из других модулей PHP, например для популярной и широкораспространенной MySQL достаточно будет всеголишь пройтись автозаменой <strong>pg_ =&gt; mysql_</strong> и слегка подредактировать параметры некоторых функций.</p><p>Перейдем к реализации установления соединения с СУБД, не стоит ожидать увидеть здесь ничего необычного:</p><div class=highlight><pre><span class=cp>&lt;?php</span>
<span class=k>static</span> <span class=k>function</span> <span class=nf>connect</span><span class=p>()</span>  <span class=c1>// установка соединения</span>
<span class=p>{</span>
  <span class=nx>self</span><span class=o>::</span><span class=nv>$connection</span><span class=o>=</span><span class=nb>pg_pconnect</span><span class=p>(</span><span class=s2>"host=localhost dbname=pgsql user=pgsql password=MyPassword"</span><span class=p>);</span>
  <span class=c1>// не забываем менять указанные данные для авторизации на правильные</span>
  <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nb>isset</span><span class=p>(</span><span class=nx>self</span><span class=o>::</span><span class=nv>$connection</span><span class=p>))</span>
  <span class=p>{</span>
    <span class=k>echo</span> <span class=s2>"Сайт не работает по техническим причинам.</span>
<span class=s2>Просим прощения за доставленные неудобства."</span><span class=p>;</span>
    <span class=k>exit</span><span class=p>;</span>   <span class=c1>// ни в коем случае не выводим более информативных сообщений об ошибке, чем это</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cp>?&gt;</span><span class=x></span>
</pre></div><p>А вот с отправкой и обработкой результатов запросов ситуация далеко не так однозначна. Помимо простой передачи самого текста запроса в СУБД, необходимо правильно определить тип запроса и в соответствии с этим обработать результат. Можно конечно попытаться сделать это автоматически на основе вытаскивания первого слова из текста запроса, но мне всетаки кажется более предпочтительным определение "вручную" желаемого вида представление результата. Выполнение произвольных запросов может выглядеть, например, следующим образом:</p><div class=highlight><pre><span class=cp>&lt;?php</span>
<span class=k>static</span> <span class=k>function</span> <span class=nf>query</span><span class=p>(</span><span class=nv>$str</span><span class=p>,</span><span class=nv>$bool</span><span class=o>=</span><span class=k>false</span><span class=p>)</span> <span class=c1>// произвольный запрос</span>
<span class=p>{</span>
  <span class=c1>//echo $str."</span>
<span class=s2>"; // очень удобно на стадии разработки в процессе поиска ошибок</span>
<span class=s2>  </span><span class=si>$result</span><span class=s2>=@pg_query(self::</span><span class=si>$connection</span><span class=s2>,</span><span class=si>$str</span><span class=s2>); // @ - для сокрытия теоретически возможных ошибок</span>
<span class=s2>  // or die('Query failed: '.pg_last_error());</span>
<span class=s2>  // не забываем убирать в комментарий в финальном варианте проекта</span>
<span class=s2>  // или совсем удалять</span>
<span class=s2>  if(</span><span class=si>$result</span><span class=s2>)  // Если получен результат, отличный от false</span>
<span class=s2>  {</span>
<span class=s2>    if(</span><span class=si>$bool</span><span class=s2>)  // Если выбран результат в виде boolean</span>
<span class=s2>    {</span>
<span class=s2>      return true;</span>
<span class=s2>    }</span>
<span class=s2>    else  // Если выбран результат в виде массива</span>
<span class=s2>    {</span>
<span class=s2>      </span><span class=si>$n</span><span class=s2>=pg_num_rows(</span><span class=si>$result</span><span class=s2>);  // для создания универсального формата массива</span>
<span class=s2>      if(</span><span class=si>$n</span><span class=s2>==1)return pg_fetch_array(</span><span class=si>$result</span><span class=s2>,0,PGSQL_ASSOC);</span>
<span class=s2>      else  // даже когда результат содержит только одну строку</span>
<span class=s2>      {</span>
<span class=s2>        </span><span class=si>$j</span><span class=s2>=pg_num_rows(</span><span class=si>$result</span><span class=s2>);</span>
<span class=s2>        </span><span class=si>$list</span><span class=s2>=array();</span>
<span class=s2>        for(</span><span class=si>$i</span><span class=s2>=0;</span><span class=si>$i</span><span class=s2>&lt;</span><span class=si>$j</span><span class=s2>;</span><span class=si>$i</span><span class=s2>++)</span>
<span class=s2>        </span><span class=si>$list</span><span class=s2>[]=pg_fetch_array(</span><span class=si>$result</span><span class=s2>,</span><span class=si>$i</span><span class=s2>,PGSQL_ASSOC);</span>
<span class=s2>        return </span><span class=si>$list</span><span class=s2>;</span>
<span class=s2>      }</span>
<span class=s2>    }</span>
<span class=s2>  }else return false;</span>
<span class=s2>}</span>
<span class=s2>?&gt;</span>
</pre></div><p>Помимо базовой отправки запросов, в некоторых случаях имеет смысл написать несколько методов, отправляющих частоиспользуемые запросы, что в некоторых случаях позволяет сократить объем и уменьшить нагроможденность кода. Хоть я и предпочитаю не пользоваться такими вещами, но привести пример такого рода метода все же стоит:</p><div class=highlight><pre><span class=cp>&lt;?php</span>
<span class=k>static</span> <span class=k>function</span> <span class=nf>selectAll</span><span class=p>(</span><span class=nv>$table</span><span class=p>)</span>
<span class=p>{</span> <span class=c1>// пример метода отправки чаcтоиспользуемых запросов</span>
  <span class=k>return</span> <span class=nx>self</span><span class=o>::</span><span class=na>query</span><span class=p>(</span><span class=s2>"select * from "</span><span class=o>.</span><span class=nv>$table</span><span class=o>.</span><span class=s2>";"</span><span class=p>);</span>
<span class=p>}</span>
<span class=cp>?&gt;</span><span class=x></span>
</pre></div><p>Если чувствуете необходимость в подобных функциях, можно написать огромное количество, все ограничивается лишь Вашим воображением и знаниями SQL.</p><p>Что ж, осталось лишь собрать весь код в единый листинг:</p><div class=highlight><pre><span class=cp>&lt;?php</span>
<span class=k>class</span> <span class=nc>SQL</span>
<span class=p>{</span>
  <span class=k>private</span> <span class=k>static</span> <span class=nv>$connection</span><span class=p>;</span> <span class=c1>// соединение с СУБД</span>
  <span class=k>static</span> <span class=k>function</span> <span class=nf>connect</span><span class=p>()</span>  <span class=c1>// установка соединения</span>
  <span class=p>{</span>
    <span class=nx>self</span><span class=o>::</span><span class=nv>$connection</span><span class=o>=</span><span class=nb>pg_pconnect</span><span class=p>(</span><span class=s2>"host=localhost dbname=pgsql user=pgsql password=MyPassword"</span><span class=p>);</span>
    <span class=c1>// не забываем менять указанные данные для авторизации на правильные</span>
    <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nb>isset</span><span class=p>(</span><span class=nx>self</span><span class=o>::</span><span class=nv>$connection</span><span class=p>))</span>
    <span class=p>{</span>
      <span class=k>echo</span> <span class=s2>"Сайт не работает по техническим причинам.&lt;br /&gt;Просим прощения за доставленные неудобства."</span><span class=p>;</span>
      <span class=k>exit</span><span class=p>;</span> <span class=c1>// ни в коем случае не выводим более информативных сообщений об ошибке, чем это</span>
    <span class=p>}</span>
  <span class=p>}</span>
  <span class=k>static</span> <span class=k>function</span> <span class=nf>query</span><span class=p>(</span><span class=nv>$str</span><span class=p>,</span><span class=nv>$bool</span><span class=o>=</span><span class=k>false</span><span class=p>)</span> <span class=c1>// произвольный запрос</span>
  <span class=p>{</span>
    <span class=c1>//echo $str."&lt;br&gt;"; // очень удобно на стадии разработки в процессе поиска ошибок</span>
    <span class=nv>$result</span><span class=o>=@</span><span class=nb>pg_query</span><span class=p>(</span><span class=nx>self</span><span class=o>::</span><span class=nv>$connection</span><span class=p>,</span><span class=nv>$str</span><span class=p>);</span> <span class=c1>// @ - для сокрытия теоретически возможных ошибок</span>
    <span class=c1>// or die('Query failed: '.pg_last_error());</span>
    <span class=c1>// не забываем убирать в комментарий в финальном варианте проекта</span>
    <span class=c1>// или совсем удалять</span>
    <span class=k>if</span><span class=p>(</span><span class=nv>$result</span><span class=p>)</span>  <span class=c1>// Если получен результат, отличный от false</span>
    <span class=p>{</span>
      <span class=k>if</span><span class=p>(</span><span class=nv>$bool</span><span class=p>)</span>  <span class=c1>// Если выбран результат в виде boolean</span>
      <span class=p>{</span>
        <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
      <span class=p>}</span>
      <span class=k>else</span>  <span class=c1>// Если выбран результат в виде массива</span>
      <span class=p>{</span>
        <span class=nv>$n</span><span class=o>=</span><span class=nb>pg_num_rows</span><span class=p>(</span><span class=nv>$result</span><span class=p>);</span>  <span class=c1>// для создания универсального формата массива</span>
        <span class=k>if</span><span class=p>(</span><span class=nv>$n</span><span class=o>==</span><span class=mi>1</span><span class=p>)</span><span class=k>return</span> <span class=nb>pg_fetch_array</span><span class=p>(</span><span class=nv>$result</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=nx>PGSQL_ASSOC</span><span class=p>);</span>
        <span class=k>else</span>  <span class=c1>// даже когда результат содержит только одну строку</span>
        <span class=p>{</span>
          <span class=nv>$j</span><span class=o>=</span><span class=nb>pg_num_rows</span><span class=p>(</span><span class=nv>$result</span><span class=p>);</span>
          <span class=nv>$list</span><span class=o>=</span><span class=k>array</span><span class=p>();</span>
          <span class=k>for</span><span class=p>(</span><span class=nv>$i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=nv>$i</span><span class=o>&lt;</span><span class=nv>$j</span><span class=p>;</span><span class=nv>$i</span><span class=o>++</span><span class=p>)</span>
          <span class=nv>$list</span><span class=p>[]</span><span class=o>=</span><span class=nb>pg_fetch_array</span><span class=p>(</span><span class=nv>$result</span><span class=p>,</span><span class=nv>$i</span><span class=p>,</span><span class=nx>PGSQL_ASSOC</span><span class=p>);</span>
          <span class=k>return</span> <span class=nv>$list</span><span class=p>;</span>
        <span class=p>}</span>
      <span class=p>}</span>
    <span class=p>}</span><span class=k>else</span> <span class=k>return</span> <span class=k>false</span><span class=p>;</span>

  <span class=p>}</span>
  <span class=k>static</span> <span class=k>function</span> <span class=nf>selectAll</span><span class=p>(</span><span class=nv>$table</span><span class=p>)</span>
  <span class=p>{</span> <span class=c1>// пример метода отправки чаcтоиспользуемых запросов</span>
    <span class=k>return</span> <span class=nx>self</span><span class=o>::</span><span class=na>query</span><span class=p>(</span><span class=s2>"select * from "</span><span class=o>.</span><span class=nv>$table</span><span class=o>.</span><span class=s2>";"</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=cp>?&gt;</span><span class=x></span>
</pre></div><p>```</p><p>Вот так вот оно и выглядит в простейшем варианте, дорабатывать под собственные нужды код можно до бесконечности естественно, но в большинстве случаев даже такой реализации вполне должно хватать.</p><p>Эта статья является частью <a href=https://www.insight-it.ru/dzhentelmenskij-nabor-php-programmista/ >серии статей "Джентельменский набор PHP программиста"</a>, если Вам понравилась эта статья то очень вероятно, что Вам придутся по душе и остальные статьи.</p><p>Не забываем <a href=/feed/ >подписываться на RSS блога</a>!</p><div class=sharrre-wrapper><div class=twitter data-url=https://www.insight-it.ru/php/2008/obshhaemsya-s-bazojj-dannykh/ data-text="Общаемся с базой данных" data-title=Tweet></div><div class=facebook data-url=https://www.insight-it.ru/php/2008/obshhaemsya-s-bazojj-dannykh/ data-text="Общаемся с базой данных" data-title=Like></div><div class=linkedin data-url=https://www.insight-it.ru/php/2008/obshhaemsya-s-bazojj-dannykh/ data-text="Общаемся с базой данных" data-title="In Share" ></div></div><div class="card-panel light-blue darken-2 light-blue-text text-lighten-4"><span class=published title=2008-01-16T22:04:00+03:00>16 января 2008</span>&nbsp;|&nbsp;<span class="vcard author"><a class="url fn light-blue-text text-lighten-4" href=https://www.insight-it.ru/author/ > Иван Блинков </a></span>&nbsp;|&nbsp;<a href=https://www.insight-it.ru/category/php/ class="light-blue-text text-lighten-4" > PHP </a>&nbsp;|&nbsp;<a href=https://www.insight-it.ru/php/2008/obshhaemsya-s-bazojj-dannykh/#comments class="light-blue-text text-lighten-4" title="21 комментариев"> 21 <i class=icon-chat></i></a></div><div class=taglist class=row><a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/mysql/ > MySQL </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/php/ > PHP </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/postgresql/ > PostgreSQL </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/sql/ > SQL </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/bd/ > БД </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/interfeis/ > интерфейс </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/koding/ > кодинг </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/oop/ > ООП </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/subd/ > СУБД </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/tekhnologiia/ > технология </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/khranenie-dannykh/ > хранение данных </a>&ensp;</div></footer></article></section></div><div class=after><div id=comments><h4>21 комментариев</h4><ul class=comments-list><li class=comment><em>Arboleda, 2010-06-13T11:00:07:<em> Интересно. Значит надо какие-нибудь поправки вносить. </li><li class=comment><em>Alex, 2009-10-10T08:16:21:<em> Приветствую всех.Данная статья очень напоминает изобретение велосипеда.Если обратиться к классикам, то стоит взглянуть на книгу"Разработка Web-приложений с помощью PHP и MySQL", которую написали Л. Веллинг и Л.Томпсон (третье! издание было издано в 2005! году).Авторы данной книги исповедуют подход выделения кода обращения к БДв отдельные функции (которые можно многократно использовать и в других проектах).Таким образом код не захламляется ненужными повторениями иобладает отличной наглядностью.П.С. Как вы боретесь с дублированием страниц в индексе поисковых систем, если все урл сайта содержат идентификатор сессии? </li><li class=comment><em>Zeke Fast, 2008-06-13T19:02:51:<em> Привет всем!1. Мне кажется, что спор заварился по той причине, что до конца не было понято о чем спрорим. Спорить о применении готовых решений и реализации своего, мотивируя тем, что код лучше контролируется глупость по нескольким причинам. Одна из них потому что каждое решение в пределе приводит к абсурду: либо брать все готовое и не программировать, а заниматься настройкой и кастомизацией, либо программировать все что только можно самому (включая ОС) потому что так можно лучше разобраться. А так как разработчикам хочется быть аля изобретателями-учеными, но сильно при этом не напрягаясь, то приходиться искать золотую середину. (Как всегда ;-)) И на мой взгляд, это единственно верное решение. Как с точки бизнеса так и с точки разработчика и получения им удовлетворения от своей работы.Тем же кто продолжит говорить, что лучше все делать самому, чем использовать готовые решения могу сказать: либо вы семи пядей во лбу либо глупец, потому как не хотите использовать накопленный и реализованный в определенном решении опыт людей уже прошедших по пути, на который вы только ступили.В защиту ORM могу привести такие продукты как Propel & Hibernate. По моему популярность последнего все говорит сама за себя.Так же есть альтернатива ORM модели называемая DAO (Data Access Object) и не плохая ее реализации в SqlMap framework, который является частью Prado framework.Всем спасибо за интересную дискуссию разгоревшуюся на не очень актуальной (для меня) теме. </li><li class=comment><em>Иван Блинков, 2008-03-22T17:19:57:<em> [quote comment="396"]А из-за чего в вашем случае такая ошибка могла произойти? А то я сейчас хочу перевести один сайт с apache + cgi (perl) на nginx + fastcgi, а теперь даже и не знаю стоит ли... Вдруг такие же ошибки будут иногда всплывать?А какая версия nginx у вас?[/quote]Не в версии дело, просто хостинг-провайдер размещает слишком много сайтов на одном сервере. Это, видимо, одно из следствий...Возникает достаточно редко (сильно меньше одного процента вероятность 502 увидеть), так что не хочется пока техподдержку беспокоить по этому вопросу, тем более почти уверен, что это ничего не даст.Server: nginx/0.5.35 </li><li class=comment><em>Костя, 2008-03-22T17:01:40:<em> А из-за чего в вашем случае такая ошибка могла произойти? А то я сейчас хочу перевести один сайт с apache + cgi (perl) на nginx + fastcgi, а теперь даже и не знаю стоит ли... Вдруг такие же ошибки будут иногда всплывать?А какая версия nginx у вас? </li><li class=comment><em>Иван Блинков, 2008-03-22T14:47:34:<em> [quote comment="389"]Получил ответ от nginx:502 bad gatewayПосле F5 страница загрузилась. Что у вас в бэкенде крутится?[/quote]Shared хостинг за 150р./мес., со всеми вытекающими последствиями...А на нем соответственно nginx, PHP, и MySQL, а также WordPress в роли CMS. </li><li class=comment><em>Костя, 2008-03-22T14:10:34:<em> Получил ответ от nginx:502 bad gatewayПосле F5 страница загрузилась. Что у вас в бэкенде крутится? </li><li class=comment><em>Иван Блинков, 2008-03-03T16:42:32:<em> [quote comment="323"]Традиционный парадокс - квалификация и продуктивность любого программиста на PHP выше чем квалификация любого другого программиста на PHP либо группы таких программистов.[/quote]Извините, из-за крайнего недостатка запятых мне не удалось уловить мысль этого предложения :(А насчет остального обсуждения, я пожалуй "постою в сторонке", так как не являюсь большим любителем темы разговора... </li><li class=comment><em>Fritz, 2008-03-03T15:49:52:<em> Традиционный парадокс - квалификация и продуктивность любого программиста на PHP выше чем квалификация любого другого программиста на PHP либо группы таких программистов.ORM используют в массе гораздо более реальных проектов чем большинство таковых на ПХП </li><li class=comment><em>Екимов Сергей, 2008-03-02T20:24:20:<em> есть отличная библиотека DbSimplehttp://dklab.ru/lib/DbSimple </li><li class=comment><em>korchasa, 2008-02-23T10:18:43:<em> [quote comment="158"]незнаю про ORMы все одно мнение - для реальных проектов ЭТО ВСЕ ХЛАМ) по той причине что с ними нет возможности иметь сложные взаимосвязи между данными, по сути это взаимодействие всегда сводиться к ХИТРОВЫЕ..АНОМУ запросу к БД) который никак не разложить по объектам[/quote]Можно пример? А то не очень понятно о чем речь. Ваш запрос не может быть отражен в объекты(ы)? Заведите такой объект в который он может быть отражен. ORM не отрицает использование SQL запросов.[quote]которые каждый привязан к своей таблице[/quote]С чего бы ему быть привязанным? Это скорее проблемы тех решений, с которыми вы лично работали.[quote] и т.д. к томуже МОДУЛЬНОСТЬ - это очень узко, это подразумевает модули которые вещи сами в себе а часто необходима сложная взаимосвязь между модулями и гибкость.[/quote]ORM не имеет ни какого отношения к модулям. </li><li class=comment><em>Иван Блинков, 2008-02-13T19:13:04:<em> [quote comment="154"]Выглядит, как будто “я не пробовал, но вроде отстой”.[/quote]Нет, выглядит как мое мнение о теме в целом, не вдаваясь в какие-либо подробности о конкретном продукте, с которым мне доводилось иметь дело, пускай и недолгое. </li><li class=comment><em>bez, 2008-02-13T17:23:35:<em> к томуже ORM всегда подразумевает строгую реляционную модель данных) что для высоконагруженных проектов является НЕРЕАЛЬНЫМ </li><li class=comment><em>bez, 2008-02-13T17:20:21:<em> незнаю про ORMы все одно мнение - для реальных проектов ЭТО ВСЕ ХЛАМ) по той причине что с ними нет возможности иметь сложные взаимосвязи между данными, по сути это взаимодействие всегда сводиться к ХИТРОВЫЕ..АНОМУ запросу к БД) который никак не разложить по объектам которые каждый привязан к своей таблице и т.д. к томуже МОДУЛЬНОСТЬ - это очень узко, это подразумевает модули которые вещи сами в себе а часто необходима сложная взаимосвязь между модулями и гибкость. </li><li class=comment><em>Sergey Shepelev, 2008-02-13T08:52:59:<em> Выглядит, как будто “я не пробовал, но вроде отстой”. </li><li class=comment><em>Иван Блинков, 2008-02-12T17:39:57:<em> [quote comment="144"]1. Использования фреймворков для создания веб-приложений. Допустим, у нас задача хитрее, чем блог, т.е. готового веб-приложения нет.2. Использования готовых DBA-прослоек (таких, как PEAR::MDB2) вместо самописных. Как частный случай фреймворков.[/quote]При желании можно было бы даже целый пост (и далеко не один) написать, описывая преимущества и/или недостатки того или иного framework'a, но если говорить вкратце, то основными недостатками, которые я могу назвать (по крайней мере лично для меня):1. отсутствие понимания (или излишне высокие издержки его получения) и полного контроля (да и порой даже частичного) над принципами работы тех частей функционала, которые работают без моего ведома (например автоматически построенные MVC модели и прочие вещи, призванные облегчить жизнь обленившегося программиста).2. универсальность; по крайней мере те из framework'ов, с которыми мне доводилось сталкиваться, решали поставленную задачу более чем неэффективно именно благодаря ей.3. издержки связанные с обучением; я лично порой страдаю "изобретением велосипедов" именно потому, что понимая принцип работы требуемой функции порой бывает быстрее (и иногда, но не всегда, эффективнее) ее написать самому, чем напрягать лишний раз Google в попытках найти "готовенькое" или то, как этим "готовеньким" можно воспользоваться.4. свобода; независимость от программистов, написавших framework, и их решений относительно каких-либо вопросов, связанных с вариантами реализации чего-либо или чем-нибудь еще.Вот это были мои мысли насчет framework'ов в целом, не могу похвастаться богатым опытом работы с ними, так что что-то более конкретное про многие из них я сказать врядли смогу, PEAR можно по большому счету тоже отнести к сказанным выше словам, но я ими вообще предпочитаю лишний раз не пользоваться без особой необходимости (которой пока ни разу не возникало). </li><li class=comment><em>Sergey Shepelev, 2008-02-12T14:00:33:<em> 1. Использования фреймворков для создания веб-приложений. Допустим, у нас задача хитрее, чем блог, т.е. готового веб-приложения нет.2. Использования готовых DBA-прослоек (таких, как PEAR::MDB2) вместо самописных. Как частный случай фреймворков. </li><li class=comment><em>Иван Блинков, 2008-02-11T15:00:06:<em> [quote comment="129"]Давайте рассмотрим недостатки.[/quote]Чего именно? Framework'ов? CMS? Собственноручно написанного кода? </li><li class=comment><em>Sergey Shepelev, 2008-02-11T11:42:16:<em> Давайте рассмотрим недостатки. </li><li class=comment><em>Иван Блинков, 2008-02-04T20:42:36:<em> Да-да, и для этого аспекта веб-разработки тоже можно найти массу готовеньких решений на блюдечке с голубой каёмочкой, если есть желание - почему бы и нет? С таким же успехом можно и готовые веб-приложения найти - вариант тоже очень неплохой, особенно если задача тривиальна, и по-моему даже он не смотря на свои массу недостатков на порядок лучше использования большинства framework'ов (мое мнение именно таково). Пример такой тривиальной задачи Вы как раз и привели - блог, например этот очень неплохо себя чувствует на готовом решении под названием WordPress. </li><li class=comment><em>Sergey Shepelev, 2008-02-04T10:56:42:<em> Над этой проблемой люди задумались давно, написана масса врапперов, позволяющих выполнять запросики в СУБД-независимом стиле. Под PHP вам будет полезно взглянуть на PEAR::MDB2.А теперь задумайтесь над другой проблемой.Какого хрена, я, как разработчик веб-приложения (а не извращенного шаблона) должен вообще думать об SQL? Меня волнуют, например блог, - статьи, комментарии, а не строки и поля базы данных. Решение в том, чтобы хранить объекты. Например, комментарий — это объект, который обладает:свойствами - имя автора, текст (публичные), адрес эл. почты, IP-адрес (скрытые),методами - публикация, скрытие, удаление,связями - со статьей, с пользователем, если последний также является объектом в вашей архитектуре.Это теория. На практике мы либо изобретаем хитрую СУБД (например, Zope Object Database), которая сразу хранит объекты, либо изобретаем прослойку, которая позволяет хранить объекты в традиционных реляционных базах. Такие прослойки получили название <abbr title="Object Relational Model">ORM</abbr>. Советую взглянуть на SQLAlchemy. В любом случае, вы пишете код для доступа к объектам, вас не волнует как именно они хранятся. Это просто, удобно и очень приятно. </li></ul></div><script type=text/javascript>
        var disqus_shortname = 'insight-it';
        var disqus_identifier = '26 http://www.insight-it.ru/programming/php/obshhaemsya-s-bazojj-dannykh/';
        var disqus_url = 'https://www.insight-it.ru/php/2008/obshhaemsya-s-bazojj-dannykh/';
        var disqus_domain = 'disqus.com';
        var disqus_title = 'Общаемся с базой данных';
        var disqus_container_id = 'comments';
        (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//insight-it.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script></div></div><div class="col hide-on-small-only m3 l2"><div class=card><a href=https://www.insight-it.ru/author><div class="card-image tooltipped" data-position=top data-delay=50 data-tooltip="Автор Insight IT"><img src=https://www.insight-it.ru/images/avatar.jpeg><span class=card-title>Иван Блинков</span></div></a></div><div class=toc-wrapper><div style="height: 1px;"></div></div></div></div></div></main><footer class=page-footer><div id=footer class=container><div class=row><div class="col m4 s12"><h5 class=white-text>Иван Блинков</h5><ul><li><a href=mailto:insight-it@blinkov.ru rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-mail white-text"></i> insight-it@blinkov.ru </span></a></li><li><a href=https://www.linkedin.com/in/ivanblinkov rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-linkedin light-blue-text text-darken-3"></i> LinkedIn </span></a></li><li><a href=https://twitter.com/blinkov rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-twitter cyan-text text-accent-2"></i> @blinkov </span></a></li><li><a href="http://plus.google.com/102882395551389724078?rel=author" rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-gplus red-text"></i> Google </span></a></li><li><a href=https://www.facebook.com/ivan.blinkov rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-facebook blue-text text-darken-3"></i> Facebook </span></a></li><li><a href=https://www.insight-it.ru/feed/ rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-rss orange-text"></i> Подписаться по RSS </span></a></li></ul><a href=//feeds.feedburner.com/insight-it/feed target=_blank rel="external nofollow"><img src="//feeds.feedburner.com/~fc/insight-it/feed?bg=b3e5fc&amp;fg=222222&amp;anim=1" height=26 width=88></a>&nbsp;<a href=//twitter.com/blinkov target=_blank rel="external nofollow"><img src=//button.twittercounter.com/animated/blinkov/222222/b3e5fc width=88 height=26></a></div><div class="col m4 s12"><h5 class=white-text>Рубрики</h5><ul><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/highload/ > Высокие нагрузки </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/interactive/ > Интерактивные сайты </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/linux/ > Linux </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/python/ > Python </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/erlang/ > Erlang </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/storage/ > Хранение данных </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/frontend/ > Frontend </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/theory/ > Теория </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/event/ > Мероприятия </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/misc/ > Разное </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/php/ > PHP </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/security/ > Безопасность </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/vacancy/ > Вакансии </a></li></ul><h5 class=white-text>Навигация</h5><ul><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/blog/ >Блог</a></li><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/about/ >О&nbsp;сайте</a></li><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/author/ >Об&nbsp;авторе</a></li></ul></div><div class="col m4 s12"><h5 class="white-text center-align">Теги</h5><div class="tagcloud taglist"><span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/programmirovanie/ > Программирование </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/meropriiatiia/ > мероприятия </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/masshtabiruemost/ > Масштабируемость </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/apache/ > Apache </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/informatsionnye-tekhnologii/ > информационные технологии </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/memcached/ > Memcached </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/internet/ > интернет </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/google/ > Google </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/mysql/ > MySQL </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/c/ > C++ </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/arkhitektura/ > архитектура </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/hbase/ > HBase </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/tekhnologiia/ > технология </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/python/ > Python </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/javascript/ > JavaScript </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/oop/ > ООП </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/nginx/ > nginx </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/facebook/ > Facebook </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/highload/ > highload </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/php/ > PHP </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/razrabotka/ > разработка </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/hadoop/ > Hadoop </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/online/ > online </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/linux/ > Linux </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/java/ > Java </a></span>&ensp;</div></div></div></div><div class=footer-copyright><div class=container> © Insight IT, 2008-2015 <a class="license right tooltipped" rel="license nofollow" target=_blank href=http://creativecommons.org/licenses/by-nc-nd/4.0/ data-position=top data-delay=50 data-tooltip="Все материалы опубликованы под лицензией Creative Commons Attribution-NonCommercial-NoDerivatives 4.0"><img alt="Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License" src=https://www.insight-it.ru/theme/images/license.png></a></div></div></footer><script src=//code.jquery.com/jquery-2.1.1.min.js></script><script src=https://www.insight-it.ru/theme/js/main.js?b5bb290d></script><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js ','ga');
ga('create', 'UA-3403373-1', 'auto');
ga('send', 'pageview');
</script><script type=text/javascript>(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter30650472 = new Ya.Metrika({id:30650472, webvisor:true, clickmap:true, trackLinks:true, accurateTrackBounce:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src=//mc.yandex.ru/watch/30650472 style="position:absolute; left:-9999px;" alt></div></noscript></body></html>