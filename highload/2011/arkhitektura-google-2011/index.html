<!DOCTYPE html>
<html lang=ru xmlns=http://www.w3.org/1999/xhtml xmlns:og=http://ogp.me/ns# xmlns:fb=https://www.facebook.com/2008/fbml><head><meta http-equiv=Content-Type content="text/html; charset=UTF-8"><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=msapplication-tap-highlight content=no><title>Архитектура Google 2011</title><link href="//fonts.googleapis.com/css?family=Open+Sans&amp;subset=latin,cyrillic" rel=stylesheet type=text/css><link href="//fonts.googleapis.com/css?family=PT+Sans&amp;subset=latin,cyrillic" rel=stylesheet type=text/css><link rel=stylesheet href=https://www.insight-it.ru/theme/css/main.css?5e55de6b><link rel=canonical href=https://www.insight-it.ru/highload/2011/arkhitektura-google-2011/ ><meta property=og:url content=https://www.insight-it.ru/highload/2011/arkhitektura-google-2011/ ><meta property=og:title content="Архитектура Google 2011"><meta property=og:type content=article><meta name=description content="Архитектура Google была одной из первых статьей на Insight IT. Именно она дала толчок развитию проекта: после её ..."><meta property=og:description content="Архитектура Google была одной из первых статьей на Insight IT. Именно она дала толчок развитию проекта: после её ..."><meta name=keywords content="BigTable,Caffeine,Closure,GFS,Google,GWT,highload,Percolator,Protocol Buffers,Snappy,Spanner,архитектура Google,датацентры,Масштабируемость,энергоэффективность"><meta property=og:image content=https://www.insight-it.ru/images/google-logo.jpg><meta name=author content="Иван Блинков"><meta property=og:site_name content="Insight IT"><meta property=og:locale content=ru_RU><link href=https://www.insight-it.ru/feed/index.xml type=application/rss+xml rel=alternate title="Insight IT RSS Feed"></head><body><header><div class=container><a href=# data-activates=nav-mobile class="button-collapse top-nav waves-effect waves-light circle"><i class=icon-menu></i></a></div><ul id=nav-mobile class="side-nav fixed"><li class=logo><a id=logo-container href=https://www.insight-it.ru/ class=brand-logo><h4>Insight IT</h4></a></li><li class=bold><a href=https://www.insight-it.ru/highload/ > Высокие нагрузки </a></li><li class=bold><a href=https://www.insight-it.ru/interactive/ > Интерактивные сайты </a></li><li class=no-padding><ul class="collapsible collapsible-accordion"><li class=bold><a class="collapsible-header waves-effect waves-red"> Рубрики </a><div class=collapsible-body><ul><li><a href=https://www.insight-it.ru/category/linux/ > Linux </a></li><li><a href=https://www.insight-it.ru/category/python/ > Python </a></li><li><a href=https://www.insight-it.ru/category/erlang/ > Erlang </a></li><li><a href=https://www.insight-it.ru/category/frontend/ > Frontend </a></li><li><a href=https://www.insight-it.ru/category/storage/ > Хранение данных </a></li><li><a href=https://www.insight-it.ru/category/theory/ > Теория </a></li><li><a href=https://www.insight-it.ru/category/event/ > Мероприятия </a></li><li><a href=https://www.insight-it.ru/category/misc/ > Разное </a></li><li><a href=https://www.insight-it.ru/category/index/ > Все рубрики </a></li></ul></div></li></ul></li><li class=no-padding><ul class="collapsible collapsible-accordion"><li class=bold><a class="collapsible-header waves-effect waves-red"> Страницы </a><div class=collapsible-body><ul><li><a href=https://www.insight-it.ru/blog/ > Блог </a></li><li><a href=https://www.insight-it.ru/about/ > О сайте </a></li><li><a href=https://www.insight-it.ru/author/ > Об авторе </a></li><li><a href=https://www.insight-it.ru/consulting/ > Консультации </a></li><li><a href=https://www.insight-it.ru/contact/ > Контакты </a></li><li><a href=https://www.insight-it.ru/resume/ > Резюме </a></li><li><a href=https://www.insight-it.ru/search/ > Поиск по сайту </a></li></ul></div></li></ul></li></ul></header><main><nav class=top-nav><div class=container><div class=nav-wrapper><ul id=nav-mobile class="right hide-on-med-and-down"><li class><a href=/blog/ >Блог</a></li><li class><a href=/about/ >О&nbsp;сайте</a></li><li class><a href=/author/ >Об&nbsp;авторе</a></li></ul><h1><a class=page-title> Архитектура Google 2011 </a></h1></div></div></nav><div class=container><div class=row><div class="col s12 m9 l10"><div class="materialdesign section scrollspy"><section id=content class=body><article class=entry-content><div class=card><div class=card-image><img src=https://www.insight-it.ru/images/google-logo.jpg alt="Архитектура Google 2011" title="Архитектура Google 2011" class=responsive-img></div></div><p><a href=https://www.insight-it.ru/highload/2008/arkhitektura-google/ >Архитектура Google</a> была одной из первых статьей на <strong class=trebuchet>Insight IT</strong>. Именно она дала толчок развитию проекта: после её публикации посещаемость блога увеличилась в десятки раз и появились первые сотни подписчиков. Прошли годы, информация устаревает стремительно, так что пришло время взглянуть на Google еще раз, теперь уже с позиции конца 2011 года. Что мы увидим нового в архитектуре интернет-гиганта? </p><h2 id=statistika>Статистика</h2><ul><li><strong>Общее</strong><ul><li><em>Ежедневная аудитория Google составляет около 1 миллиарда человек</em><ul><li>По данным Alexa больше половины аудитории интернета каждый день пользуются Google</li><li>По данным IWS аудитория интернета составляет 2.1 миллиарда человек</li></ul></li><li><em>Используется более 900 тысяч серверов</em><ul><li>Планируется расширение до 10 миллионов серверов в обозримом будущем</li></ul></li><li><a href=https://www.insight-it.ru/goto/4cb67b65/ rel=nofollow target=_blank title=http://www.google.com/about/datacenters/locations/index.html>12 основных датацентров в США</a>, присутствие в большом количестве точек по всему миру (более 38)</li><li>Около 32 тысяч сотрудников в 76 офисах по всему миру</li></ul></li><li><strong>Поиск</strong><ul><li>За последние 14 лет среднее время обработки одного поискового запроса уменьшилось с 3 секунд до менее 100 миллисекунд, то есть в 30 раз</li><li>Более 40 миллиардов страниц в индексе, если приравнять каждую к листу А4 они бы покрыли территорию США в 5 слоев</li><li>Более 1 квинтиллиона уникальных URL (10 в 18 степени); если распечатать их в одну строку, её длина составит 51 миллион километров, треть расстояния от Земли до Солнца</li><li>В интернете встречается примерно 100 квинтиллионов слов, чтобы набрать их на клавиатуре одному человеку потребовалось бы примерно 5 миллионов лет</li><li>Проиндексировано более 1.5 миллиардов изображений, чтобы их сохранить потребовалось бы 112 миллионов дискет, которые можно сложить в стопку высотой 391 километр</li></ul></li><li><strong>Gmail</strong><ul><li>Активных пользователей более 170 миллионов</li><li>Второй по популярности почтовый сервис в США, третий в мире (по данным comScore)</li><li>При текущем темпе роста аудитории GMail и конкурентов, он станет лидером рынка через 2-3 года</li></ul></li><li><strong>Google+</strong><ul><li>Более 40 миллионов пользователей на октябрь 2011, при запуске в июне 2011</li><li>25 миллионов пользователей за первый месяц</li><li>70:30 примерное соотношение мужчин и женщин</li><li>Себестоимость разработки больше полумиллиарда долларов</li></ul></li><li><strong>YouTube</strong><ul><li>Загружается более 13 миллионов часов видео в год</li><li>Каждую минуту загружается 48 часов видео, что соответствует почти 8 годам контента или 52 тысячам полнометражных фильмов в день</li><li>Более 700 миллиардов просмотров видео в год</li><li>Месячная аудитория составляет 800 миллионов уникальных посетителей</li><li>Несколько тысяч полнометражных фильмов в <a href=https://www.insight-it.ru/goto/18cd7d94/ rel=nofollow target=_blank title=http://www.youtube.com/movies>YouTube Movies</a></li><li>Более 10% всех видео в формате HD</li><li>13% просмотров (400 миллионов в день) происходит с мобильных устройств</li><li>До сих пор работает в убыток, лишь 14% просмотров видео приносят выручку с рекламы</li></ul></li><li><strong>Финансы</strong><ul><li>Выручка порядка 36 миллиардов долларов в год</li><li>Прибыль после налогов порядка 10 миллиардов долларов в год</li><li>Капитализация порядка 200 миллиардов долларов</li></ul></li></ul><h2 id=arkhitektura>Архитектура</h2><p><strong>Google</strong> - огромная интернет-компания, неоспоримый лидер на рынке поиска в Интернет и владелец большого количества продуктов, многие из которых также добились определенного успеха в своей нише.</p><p>В отличии от большинства интернет-компаний, которые занимаются лишь одним продуктом (проектом), архитектура Google не может быть представлена как единое конкретное техническое решение. Сегодня мы скорее будем рассматривать общую стратегию технической реализации интернет-проектов в Google, возможно слегка затрагивая и другие аспекты ведения бизнеса в Интернет.</p><p>Все продукты Google основываются на постоянно развивающейся программной платформе, которая спроектирована с учетом работы на миллионах серверов, находящихся в разных датацентрах по всему миру.</p><h3 id=oborudovanie>Оборудование</h3><p>Обеспечение работы миллиона серверов и расширение их парка - одна из ключевых статей расходов Google. Для минимизации этих издержек очень большое внимание уделяется эффективности используемого серверного, сетевого и инфраструктурного оборудования.</p><p><img alt="Использование энергии" class=right src=https://www.insight-it.ru/images/dc-home-energy-use.png title="Использование энергии"></p><p>В традиционных датацентрах потребление электричества серверами примерно равно его потреблению остальной инфраструктурой, Google же удалось снизить процент использования дополнительной электроэнергии до 14%. Таким образом суммарное энергопотребление датацентром Google сравнимо с потреблением только серверов в типичном датацентре и вдвое меньше его общего энергопотребления. Основные концепции, которые используются для достижения этого результата:</p><ul><li>Точное измерение потребления электроэнергии всеми компонентами позволяет определить возможности по его уменьшению;</li><li>В датацентрах Google тепло, что позволяет экономить на охлаждении;</li><li>При проектировании датацентра уделяется внимание даже незначительным деталям, позволяющим сэкономить даже немного - при таком масштабе это окупается;</li><li>Google умеет охлаждать датацентры практически без кондиционеров, с использованием воды и её испарения <em>(см. <a href=https://www.insight-it.ru/goto/d1cf5d6b/ rel=nofollow target=_blank title="http://www.youtube.com/watch?v=VChOEvKicQQ">как это реализовано</a> в Финляндии)</em>.</li></ul><p>В Google активно&nbsp;пропагандируют максимальное использование возобновляемой энергии. Для этого заключаются долгосрочные соглашения с её поставщиками (на 20 и более лет), что позволяет отрасли активно развиваться и наращивать мощности. Проекты по генерации возобновляемой энергии, спонсируемые Google, имеют суммарную мощность более 1.7 гигаватт, что существенно больше, чем используется для работы Google. Этой мощности хватило бы для обеспечения электричеством 350 тысяч домов.</p><p>Если говорить о жизненном цикле оборудования, то используются следующие принципы:</p><ul><li><strong>Уменьшение транспортировки:</strong> там, где это возможно, тяжелые компоненты (вроде серверных стоек) закупаются у местных поставщиков, даже если в других местах аналогичный товар можно было бы купить дешевле.</li><li><strong>Повторное использование:</strong> прежде, чем покупать новое оборудование и материалы, рассматриваются возможности по использованию уже имеющихся. Этот принцип помог избежать покупки более 90 тысяч новых серверов.</li><li><strong>Утилизация</strong>: в тех случаях, когда повторное использование невозможно, оборудование полностью очищается от данных и продается на вторичном рынке. То, что не удается продать, разбирается на материалы (медь, сталь, алюминий, пластик и.т.п.) для последующей правильной утилизации специализированными компаниями.</li></ul><p>Google известны за свои эксперименты и необычные решения в области серверного оборудования и инфраструктуры. Некоторые запатентованы; какие-то прижились, какие-то - нет. Подробно останавливаться на них не буду, лишь вкратце о некоторых:</p><ul><li>Резервное питание, интегрированное в блок питания <a href=https://www.insight-it.ru/goto/ca5b8b43/ rel=nofollow target=_blank title="http://www.youtube.com/watch?v=xgRWURIxgbU">сервера</a>, обеспеченное стандартными 12V батарейками;</li><li><a href=https://www.insight-it.ru/goto/c7f3ff41/ rel=nofollow target=_blank title=http://www.datacenterknowledge.com/closer-look-googles-server-sandwich-design/ >"Серверный сендвич"</a>, где материнские платы с двух сторон окружают водяную систему теплоотвода в центре стойки;</li><li><a href=https://www.insight-it.ru/goto/8dc33e81/ rel=nofollow target=_blank title="http://www.youtube.com/watch?v=zRwPSFpLX8I">Датацентр из контейнеров</a>.</li></ul><p>В заключении этого раздела хотелось бы взглянуть правде в глаза: <strong>идеального оборудования не бывает</strong>. У любого современного устройства, будь то сервер, коммутатор или маршрутизатор, есть шанс прийти в негодность из-за производственного брака, случайного стечения обстоятельств или других внешних факторов. Если умножить этот, казалось бы, небольшой шанс на количество оборудования, которое используется в Google, то окажется, что чуть ли не каждую минуту из строя выходит одно, или несколько, устройств в системе. На оборудование полагаться нельзя, по-этому вопрос отказоустойчивости переносится на плечи программной платформы, которую мы сейчас и рассмотрим.</p><h3 id=platforma>Платформа</h3><p>В Google очень рано столкнулись с проблемами ненадежности оборудования и работы с огромными массивами данных. Программная платформа, спроектированная для работы на многих недорогих серверах, позволила им абстрагироваться от сбоев и ограничений одного сервера.</p><p>Основными задачами в ранние годы была минимизация точек отказа и обработка больших объемов слабоструктурированных данных. Решением этих задач стали три основных слоя платформы Google, работающие один поверх другого:</p><ul><li><strong><a href=https://www.insight-it.ru/goto/479dfa95/ rel=nofollow target=_blank title=http://research.google.com/archive/gfs.html>Google File System</a>:</strong> распределенная файловая система, состоящая из сервера с метаданными и теоретически неограниченного количества серверов, хранящих произвольные данные в блоках фиксированного размера.</li><li><strong><a href=https://www.insight-it.ru/goto/f56e059a/ rel=nofollow target=_blank title=http://research.google.com/archive/bigtable.html>BigTable</a>:</strong> распределенная база данных, использующая для доступа к данным две произвольных байтовых строки-ключа (обозначающие строку и столбец) и дату/время (обеспечивающие версионность).</li><li><strong><a href=https://www.insight-it.ru/goto/dbd8fea6/ rel=nofollow target=_blank title=http://research.google.com/archive/mapreduce.html>MapReduce</a>:</strong> механизм распределенной обработки больших объемов данных, оперирующий парами ключ-значение для получения требуемой информации.</li></ul><p>Такая комбинация, дополненная другими технологиями, довольно долгое время позволяла справляться с индексацией Интернета, пока... скорость появления информации в Интернете не начала расти огромными темпами из-за "бума социальных сетей". Информация, добавленная в индекс даже через полчаса, уже зачастую становилась устаревшей.&nbsp;В дополнение к этому в рамках самого Google стало появляться все больше продуктов, предназначенных для работы в реальном времени.</p><p>Спроектированные с учетом совершенно других требований Интернета пятилетней давности компоненты, составляющие ядро платформы Google, потребовали фундаментальной смены архитектуры индексации и поиска, который около года назад был представлен публике&nbsp;под кодовым названием <strong>Google Caffeine</strong>. Новые, переработанные, версии старых "слоев" также окрестили броскими именами, но резонанса у технической публики они вызвали намного меньше, чем новый поисковый алгоритм в SEO-индустрии.</p><h4>Google Colossus</h4><p>Новая архитектура GFS была спроектирована для минимизации задержек при доступе к данным (что критично для приложений вроде GMail и YouTube), не в ущерб основным свойствам старой версии: отказоустойчивости и прозрачной масштабируемости.</p><p>В оригинальной же реализации упор был сделан на повышение общей пропускной способности: операции объединялись в очереди и выполнялись разом, при таком подходе можно было прождать пару секунд еще до того, как первая операция в очереди начнет выполняться. Помимо этого в старой версии было большое слабое место в виде единственно мастер-сервера с метаданными, сбой в котором грозил недоступностью всей файловой системы в течении небольшого промежутка времени (пока другой сервер не подхватит его функции, изначально это занимало около 5 минут, в последних версиях порядка 10 секунд) - это также было вполне допустимо при отсутствии требования работы в реальном времени, но для приложений, напрямую взаимодействующих с пользователями, это было неприемлемо с точки зрения возможных задержек.</p><p>Основным нововведением в Colossus стали распределенные мастер-сервера, что позволило избавиться не только от единственной точки отказа, но и существенно уменьшить размер одного блока с данными (с 64 до 1 мегабайта), что в целом очень положительно сказалось на работе с небольшими объемами данных. В качестве бонуса исчез теоретический предел количества файлов в одной системе.</p><p>Детали распределения ответственности между мастер-серверами, сценариев реакции на сбои, а также сравнение по задержкам и пропускной способности обоих версий, к сожалению, по-прежнему конфиденциальны. Могу предположить, что используется вариация на тему хэш-кольца с репликацией метаданных на ~3 мастер-серверах, с созданием дополнительной копии на следующем по кругу сервере в случае в случае сбоев, но это лишь догадки. Если у кого-то есть относительно официальная информация на этот счет - буду рад увидеть в комментариях.</p><p>По прогнозам Google текущий вариант реализации распределенной файловой системы "уйдет на пенсию" в 2014 году из-за популяризации твердотельных накопителей и существенного скачка в области вычислительных технологий (процессоров).</p><h4>Google Percolator</h4><p>MapReduce отлично справлялся с задачей полной перестройки поискового индекса, но не предусматривал небольшие изменения, затрагивающие лишь часть страниц. Из-за потоковой, последовательной природы MapReduce для внесения изменений в небольшую часть документов все равно пришлось бы обновлять весь индекс, так как новые страницы непременно будут каким-то образом связаны со старыми. Таким образом задержка между появлением страницы в Интернете и в поисковом индексе при использовании MapReduce была пропорциональна общему размеру индекса (а значит и Интернета, который постоянно растет), а не размеру набора измененных документов.</p><p>Ключевые архитектурные решения, лежащие в основе MapReduce, не позволяли повлиять на эту особенность и в итоге система индексации была построена заново с нуля, а MapReduce продолжает использоваться в других проектах Google для аналитики и прочих задач, по прежнему не связанных с реальным временем.</p><p>Новая система получила довольно своеобразное название <strong>Percolator</strong>, попытки узнать что оно значит приводит к различным устройствам по фильтрации дыма, кофеваркам и непойми чему еще. Но наиболее адекватное объяснение мне пришло в голову, когда я прочитал его по слогам: per col - <em>по колонкам</em>.</p><p>Percolator представляет собой надстройку над BigTable, позволяющую выполнять комплексные вычисления на основе имеющихся данных, затрагивающие много строк и даже таблиц одновременно (в стандартном API BigTable это не предусмотрено).</p><p>Веб-документы или любые другие данные изменяются/добавляются в систему посредством модифицированного API BigTable, а дальнейшие изменения в остальной базе осуществляются посредством механизма&nbsp;"обозревателей". Если говорить в терминах реляционных СУБД, то обозреватели - что-то среднее между триггерами и хранимыми процедурами. Обозреватели представляют собой подключаемый к базе данных код (на <a href=/tag/c/ >C++</a>), который исполняется в случае возникновении изменений в определенных <em>колонках</em> BigTable (откуда, видимо, и пошло название). Все используемые системой метаданные также хранятся в специальных колонках BigTable. При использовании Percolator все изменения происходят в транзакциях, удовлетворяющих принципу ACID, каждая из которых затрагивает именно те сервера в кластере, на которых необходимо внести изменения. Механизм транзакций на основе BigTable разрабатывался в рамках отдельного проекта под названием <a href=https://www.insight-it.ru/storage/2011/google-megastore/ >Google Megastore</a>.</p><p>Таким образом, при добавлении нового документа (или его версии) в поисковый индекс, вызывается цепная реакция изменений в старых документах, скорее всего ограниченная по своей рекурсивности. Эта система при осуществлении случайного доступа поддерживает индекс в актуальном состоянии.</p><p>В качестве бонуса в этой схеме удалось избежать еще двух недостатков MapReduce:</p><ul><li><strong>Проблемы "отстающих":</strong> когда один из серверов (или одна из конкретных подзадач) оказывался существенно медленнее остальных, что также значительно задерживало общее время завершения работы кластера.</li><li><strong>Пиковая нагрузка:</strong> MapReduce не является непрерывным процессом, а разделяется на работы с ограниченной целью и временем исполнения. Таким образом помимо необходимости ручной настройки работ и их типов, кластер имеет очевидные периоды простоя и пиковой нагрузки, что ведет к неэффективному использованию вычислительных ресурсов.</li></ul><p>Но все это оказалось не бесплатно: при переходе на новую систему удалось достичь той же скорости индексации, но при этом использовалось <em>вдвое</em> больше вычислительных ресурсов. Производительность Percolator находится где-то между производительностью MapReduce и производительностью традиционных СУБД. Так как Percolator является распределенной системой, для обработки фиксированного небольшого количества данных ей приходится использовать существенно больше ресурсов, чем традиционной СУБД; такова цена масштабируемости. По сравнению с MapReduce также пришлось платить дополнительными потребляемыми вычислительными ресурсами за возможность случайного доступа с низкой задержкой.</p><p><img alt="Google Percolator Benchmark" class=left src=https://www.insight-it.ru/images/google-percolator-benchmark.png title="Google Percolator Benchmark"></p><p>Тем не менее, при выбранной архитектуре Google удалось достичь практически линейного масштабирования при увеличении вычислительных мощностей на много порядков <em>(см. график, основан на тесте TPC-E)</em>. Дополнительные накладные расходы, связанные с распределенной природой решения, в некоторых случаях до 30 раз превосходят аналогичный показатель традиционных СУБД, но у данной системы есть солидный простор для оптимизации в этом направлении, чем Google активно и занимается.</p><h4>Google Spanner</h4><p>Spanner представляет собой единую систему автоматического управления ресурсами <strong>всего парка серверов</strong> Google.</p><p>Основные особенности:</p><ul><li>Единое пространство имен:<ul><li>Иерархия каталогов</li><li>Независимость от физического расположения данных</li></ul></li><li>Поддержка слабой и сильной целостности данных между датацентрами</li><li>Автоматизация:<ul><li>Перемещение и добавление реплик данных</li><li>Выполнение вычислений с учетом ограничений и способов использования</li><li>Выделение ресурсов на всех доступных серверах</li></ul></li><li>Зоны полу-автономного управления</li><li>Восстановление целостности после потерь соединения между датацентрами</li><li>Возможность указания пользователями высокоуровневых требований, например:<ul><li>99% задержек при доступе к этим данным должны быть до 50 мс</li><li>Расположи эти данные на как минимум 2 жестких дисках в Европе, 2 в США и 1 в Азии</li></ul></li><li>Интеграция не только с серверами, но и с сетевым оборудованием, а также системами охлаждения в датацентрах</li></ul><p>Проектировалась из расчета на:</p><ul><li>1-10 миллионов серверов</li><li>~10 триллионов директорий</li><li>~1000 петабайт данных</li><li>100-1000 датацентров по всему миру</li><li>~1 миллиард клиентских машин</li></ul><p>Об этом проекте Google известно очень мало, официально он был представлен публике лишь однажды в 2009 году, с тех пор лишь местами упоминался сотрудниками без особой конкретики. Точно не известно развернута ли эта система на сегодняшний день и если да, то в какой части датацентров, а также каков статус реализации заявленного функционала.</p><h4>Прочие компоненты платформы</h4><p>Платформа Google в конечном итоге сводится к набору сетевых сервисов и библиотек для доступа к ним из различных языков программирования (в основном используются&nbsp;<a href=/tag/c/ >C/C++</a>,&nbsp;<a href=/tag/java/ >Java</a>,&nbsp;<a href=/tag/python/ >Python</a> и&nbsp;<a href=/tag/perl/ >Perl</a>). Каждый продукт, разрабатываемый Google, в большинстве случаев использует эти библиотеки для осуществления доступа к данным, выполнения комплексных вычислений и других задач, вместо стандартных механизмов, предоставляемых операционной системой, языком программирования или opensource библиотеками.</p><p>Вышеизложенные проекты составляют лишь основу платформы Google, хотя она включает в себя куда больше готовых решений и библиотек, несколько примеров из публично доступных проектов:</p><ul><li><a href=https://www.insight-it.ru/goto/f5686a9/ rel=nofollow target=_blank title=http://code.google.com/webtoolkit/ >GWT</a> для реализации пользовательских интерфейсов на <a href=/tag/java/ >Java</a>;</li><li><a href=https://www.insight-it.ru/goto/7f9cb797/ rel=nofollow target=_blank title=http://code.google.com/closure/ >Closure</a> - набор инструментов для работы с <a href=/tag/javascript/ >JavaScript</a>;</li><li><a href=https://www.insight-it.ru/goto/41604156/ rel=nofollow target=_blank title=http://code.google.com/apis/protocolbuffers/ >Protocol Buffers</a> - не зависящий от языка программирования и платформы формат бинарной сериализации структурированных данных, используется при взаимодействии большинства компонентов системы внутри Google;</li><li><a href=https://www.insight-it.ru/goto/bb496d06/ rel=nofollow target=_blank title=http://code.google.com/p/leveldb/ >LevelDB</a> - высокопроизводительная встраиваемая <a href=/tag/subd/ >СУБД</a>;</li><li><a href=https://www.insight-it.ru/goto/44c46d8/ rel=nofollow target=_blank title=http://code.google.com/p/snappy/ >Snappy</a> - быстрая компрессия данных, используется при хранении данных в GFS.</li></ul><h2 id=podvodim-itogi_1>Подводим итоги</h2><ul><li><strong>Стабильные, проработанные и повторно используемые базовые компоненты проекта</strong><em>- залог её стремительного развития, а также создания новых проектов на той же кодовой базе</em>.</li><li>Если задачи и обстоятельства, с учетом которых проектировалась система, существенно изменились&nbsp;<em>- не бойтесь вернуться на стадию проектирования и реализовать новое решение</em>.</li><li><em>Используйте инструменты, подходящие для решения каждой конкретной задачи</em>, а не те, которые навязывает мода или привычки участников команды.</li><li>Даже, казалось бы, незначительные недоработки и допущения на большом масштабе могут вылиться в огромные потери <em>- уделяйте максимум внимания деталям при реализации проекта.</em></li><li>Нельзя полагаться даже на очень дорогое оборудование <em>- все ключевые сервисы должны работать минимум на двух серверах, в том числе и базы данных.</em></li><li>Распределенная платформа, общая для всех проектов, позволит новым разработчикам легко вливаться в работу над конкретными продуктами, с минимумом представления о внутренней архитектуре компонентов платформы.</li><li>Прозрачная работа приложений в нескольких датацентрах - одна из самых тяжелых задач, с которыми сталкиваются интернет-компании. Сегодня каждая из них решает её по-своему и держит подробности в секрете, что сильно замедляет развитие opensource решений.</li></ul><h2 id=istochniki-informatsii>Источники информации</h2><p>Не гарантирую достоверность всех нижеизложенных источников информации, ставших основой для данной статьи, но ввиду конфиденциальности подобной информации на большее рассчитывать не приходится.</p><p>Поправки и уточнения приветствуются :)</p><ul><li><em><a href=https://www.insight-it.ru/goto/4431029a/ rel=nofollow target=_blank title=http://www.google.com/about/datacenters/index.html>Official Google Data Centers Site</a></em></li><li><a href=https://www.insight-it.ru/goto/7437fe8a/ rel=nofollow target=_blank title=http://research.google.com/people/jeff/WSDM09-keynote.pdf>Challenges in Building Large-Scale Information Retrieval Systems</a> (Jeff Dean, WCDMA '09)</li><li><a href=https://www.insight-it.ru/goto/557e7b3d/ rel=nofollow target=_blank title=https://www.cs.cornell.edu/projects/ladis2009/talks/dean-keynote-ladis2009.pdf>Designs, Lessons and Advice from Building Large Distributed Systems</a> (Jeff Dean, Ladis '09)</li><li><em><a href=https://www.insight-it.ru/goto/6ec4bc06/ rel=nofollow target=_blank title=http://research.google.com/pubs/pub36726.html>Google Percolator official paper</a></em></li><li><a href=https://www.insight-it.ru/goto/3473b129/ rel=nofollow target=_blank title=http://research.google.com/pubs/pub36971.html><em>Google Megastore official paper</em></a></li><li><em><a href=https://www.insight-it.ru/goto/dd8bec64/ rel=nofollow target=_blank title=http://www.theregister.co.uk/2010/09/24/google_percolator/ >Google Percolator</a></em></li><li><em><a href=https://www.insight-it.ru/goto/82efffd8/ rel=nofollow target=_blank title=http://www.theregister.co.uk/2010/09/09/google_caffeine_explained/ >Google Caffeine Explained</a></em></li><li><a href=https://www.insight-it.ru/goto/63b6ec67/ rel=nofollow target=_blank title=http://www.theregister.co.uk/2009/10/23/google_spanner/ >Google Spanner</a></li><li><a href=https://www.insight-it.ru/goto/46520ede/ rel=nofollow target=_blank title=http://www.theregister.co.uk/2011/06/08/google_software_infrastructure_dubbed_obsolete_by_ex_employee/ >Google Software Infrastructure Dubbed Obsolete by ex-Employee</a></li><li><em><a href=https://www.insight-it.ru/goto/49879386/ rel=nofollow target=_blank title=http://www.theregister.co.uk/2011/06/23/google_moves_off_the_google_file_system/ >Google Moves Off the Google File System</a></em></li><li><em>Google Internet Stats</em></li><li><em><a href=https://www.insight-it.ru/goto/d11024ba/ rel=nofollow target=_blank title=http://www.businessblogshub.com/2010/10/google-statistics-yes-they-are-very-big/ >Google Statistics</a></em></li><li><em><a href=https://www.insight-it.ru/goto/bb33b2dd/ rel=nofollow target=_blank title=http://www.splashnology.com/article/google-plus-killer-facts-and-statistics-inforgaphics/2689/ >Google Plus - Killer Facts and Statistics</a></em></li><li><em><a href=https://www.insight-it.ru/goto/d20404a7/ rel=nofollow target=_blank title=http://www.youtube.com/t/press_statistics>YouTube statistics</a></em></li><li><a href=https://www.insight-it.ru/goto/9909f6c8/ rel=nofollow target=_blank title=http://www.alexa.com/siteinfo/google.com><em>Alexa on Google</em></a></li><li><a href=https://www.insight-it.ru/goto/b088e740/ rel=nofollow target=_blank title=http://www.internetworldstats.com/stats.htm><em>Internet World Stats</em></a></li><li><em><a href=https://www.insight-it.ru/goto/86a009d0/ rel=nofollow target=_blank title="http://www.google.com/finance?fstype=bi&amp;cid=694653">Google Inc. financials</a></em></li><li><em><a href=https://www.insight-it.ru/goto/2515e26d/ rel=nofollow target=_blank title=http://www.geekwire.com/2011/stats-hotmail-top-worldwide-gmail-posts-big-gains>Hotmail still on top worldwide; Gmail gets bigger</a></em></li><li><a href=https://www.insight-it.ru/goto/2428f635/ rel=nofollow target=_blank title=http://www.datacenterknowledge.com/archives/2011/08/01/report-google-uses-about-900000-servers/ ><em>Google Server Count</em></a></li><li><em><a href=https://www.insight-it.ru/goto/b6d09313/ rel=nofollow target=_blank title=http://www.datacenterknowledge.com/archives/2009/10/20/google-envisions-10-million-servers/ >Google Envisions 10 Million Servers</a></em></li><li><a href=https://www.insight-it.ru/goto/bb3d77a4/ rel=nofollow target=_blank title=http://www.datacenterknowledge.com/archives/2008/03/27/google-data-center-faq/ ><em>Google Data Center FAQ</em></a></li></ul><h3 id=bonus-tipichnyi-pervyi-god-klastera-v-google>Бонус: типичный первый год кластера в Google</h3><ul><li>~1/2 перегрева (большинство серверов выключаются в течении 5 минут, 1-2 дня на восстановление)</li><li>~1 отказ распределителя питания (~500-1000 резко пропадают, ~6 часов на восстановление)</li><li>~1 передвижение стойки (много передвижений, 500-100 машин, 6 часов)</li><li>~1 перепрокладка сети (последовательной отключение ~5% серверов на протяжении 2 дней)</li><li>~20 отказов стоек (40-80 машин мгновенно исчезают, 1-6 часов на восстановление)</li><li>~5 стоек становится нестабильными (40-80 машин сталкиваются с 50% потерей пакетов)</li><li>~8 запланированных технических работ с сетью (при четырех могут случаться случайные получасовые потери соединения)</li><li>~12 перезагрузок маршрутизаторов (потеря DNS и внешних виртуальных IP на несколько минут)</li><li>~3 сбоя маршрутизаторов (восстановление в течении часа)</li><li>Десятки небольших 30-секундных пропаданий DNS</li><li>~1000 сбоев конкретных серверов (~3 в день)</li><li>Много тысяч сбоев жестких дисков, проблем с памятью, ошибок конфигурации и т.п.</li></ul><div class=sharrre-wrapper><div class=twitter data-url=https://www.insight-it.ru/highload/2011/arkhitektura-google-2011/ data-text="Архитектура Google 2011" data-title=Tweet></div><div class=facebook data-url=https://www.insight-it.ru/highload/2011/arkhitektura-google-2011/ data-text="Архитектура Google 2011" data-title=Like></div><div class=linkedin data-url=https://www.insight-it.ru/highload/2011/arkhitektura-google-2011/ data-text="Архитектура Google 2011" data-title="In Share" ></div></div><div class="card-panel light-blue darken-2 light-blue-text text-lighten-4"><span class=published title=2011-11-28T01:32:00+04:00>28 ноября 2011</span>&nbsp;|&nbsp;<span class="vcard author"><a class="url fn light-blue-text text-lighten-4" href=https://www.insight-it.ru/author/ > Иван Блинков </a></span>&nbsp;|&nbsp;<a href=https://www.insight-it.ru/category/highload/ class="light-blue-text text-lighten-4" > Высокие нагрузки </a></div><div class=taglist class=row><a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/bigtable/ > BigTable </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/caffeine/ > Caffeine </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/closure/ > Closure </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/gfs/ > GFS </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/google/ > Google </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/gwt/ > GWT </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/highload/ > highload </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/percolator/ > Percolator </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/protocol-buffers/ > Protocol Buffers </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/snappy/ > Snappy </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/spanner/ > Spanner </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/arkhitektura-google/ > архитектура Google </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/datatsentry/ > датацентры </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/masshtabiruemost/ > Масштабируемость </a>&ensp;<a class="tag light-blue lighten-2 white-text" href=https://www.insight-it.ru/tag/energoeffektivnost/ > энергоэффективность </a>&ensp;</div></footer></article></section></div><div class=after><div id=comments></div><script type=text/javascript>
        var disqus_shortname = 'insight-it';
        var disqus_identifier = '1426 http://www.insight-it.ru/?p=1426';
        var disqus_url = 'https://www.insight-it.ru/highload/2011/arkhitektura-google-2011/';
        var disqus_domain = 'disqus.com';
        var disqus_title = 'Архитектура Google 2011';
        var disqus_container_id = 'comments';
        (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//insight-it.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script></div></div><div class="col hide-on-small-only m3 l2"><div class=card><a href=https://www.insight-it.ru/author><div class="card-image tooltipped" data-position=top data-delay=50 data-tooltip="Автор Insight IT"><img src=https://www.insight-it.ru/images/avatar.jpeg><span class=card-title>Иван Блинков</span></div></a></div><div class=toc-wrapper><div style="height: 1px;"><ul class="section table-of-contents"><li><a href=# title="Архитектура Google 2011">Архитектура Google 2011</a><li><a href=#statistika title=Статистика>Статистика</a></li><li><a href=#arkhitektura title=Архитектура>Архитектура</a><li><a href=#oborudovanie title=Оборудование>Оборудование</a></li><li><a href=#platforma title=Платформа>Платформа</a></li></li><li><a href=#podvodim-itogi_1 title="Подводим итоги">Подводим итоги</a></li><li><a href=#istochniki-informatsii title="Источники информации">Источники информации</a><li><a href=#bonus-tipichnyi-pervyi-god-klastera-v-google title="Бонус: типичный первый год кластера в Google">Бонус: типичный первый год кластера в Google</a></li></li></li></ul></div></div></div></div></div></main><footer class=page-footer><div id=footer class=container><div class=row><div class="col m4 s12"><h5 class=white-text>Иван Блинков</h5><ul><li><a href=mailto:insight-it@blinkov.ru rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-mail white-text"></i> insight-it@blinkov.ru </span></a></li><li><a href=https://www.linkedin.com/in/ivanblinkov rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-linkedin light-blue-text text-darken-3"></i> LinkedIn </span></a></li><li><a href=https://twitter.com/blinkov rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-twitter cyan-text text-accent-2"></i> @blinkov </span></a></li><li><a href="http://plus.google.com/102882395551389724078?rel=author" rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-gplus red-text"></i> Google </span></a></li><li><a href=https://www.facebook.com/ivan.blinkov rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-facebook blue-text text-darken-3"></i> Facebook </span></a></li><li><a href=https://www.insight-it.ru/feed/ rel=nofollow><span class="light-blue-text text-lighten-4"><i class="icon-rss orange-text"></i> Подписаться по RSS </span></a></li></ul></div><div class="col m4 s12"><h5 class=white-text>Рубрики</h5><ul><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/highload/ > Высокие нагрузки </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/interactive/ > Интерактивные сайты </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/linux/ > Linux </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/python/ > Python </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/erlang/ > Erlang </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/storage/ > Хранение данных </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/frontend/ > Frontend </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/theory/ > Теория </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/event/ > Мероприятия </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/misc/ > Разное </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/php/ > PHP </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/security/ > Безопасность </a></li><li><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/category/vacancy/ > Вакансии </a></li></ul><h5 class=white-text>Навигация</h5><ul><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/blog/ >Блог</a></li><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/about/ >О&nbsp;сайте</a></li><li class><a rel=nofollow class="grey-text text-lighten-4" href=https://www.insight-it.ru/author/ >Об&nbsp;авторе</a></li></ul></div><div class="col m4 s12"><h5 class="white-text center-align">Теги</h5><div class="tagcloud taglist"><span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/hadoop/ > Hadoop </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/masshtabiruemost/ > Масштабируемость </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/mysql/ > MySQL </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/javascript/ > JavaScript </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/apache/ > Apache </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/php/ > PHP </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/java/ > Java </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/tekhnologiia/ > технология </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/linux/ > Linux </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/c/ > C++ </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/programmirovanie/ > Программирование </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/hbase/ > HBase </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/internet/ > интернет </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/google/ > Google </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/highload/ > highload </a></span>&ensp;<span class="tag light-blue lighten-2 tag-2"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/memcached/ > Memcached </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/python/ > Python </a></span>&ensp;<span class="tag light-blue lighten-2 tag-3"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/razrabotka/ > разработка </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/arkhitektura/ > архитектура </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/oop/ > ООП </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/nginx/ > nginx </a></span>&ensp;<span class="tag light-blue lighten-2 tag-1"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/online/ > online </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/facebook/ > Facebook </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/informatsionnye-tekhnologii/ > информационные технологии </a></span>&ensp;<span class="tag light-blue lighten-2 tag-4"><a rel=nofollow class=white-text href=https://www.insight-it.ru/tag/meropriiatiia/ > мероприятия </a></span>&ensp;</div></div></div></div><div class=footer-copyright><div class=container> © Insight IT, 2008-2015 <a class="license right tooltipped" rel="license nofollow" target=_blank href=http://creativecommons.org/licenses/by-nc-nd/4.0/ data-position=top data-delay=50 data-tooltip="Все материалы опубликованы под лицензией Creative Commons Attribution-NonCommercial-NoDerivatives 4.0"><img alt="Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License" src=https://www.insight-it.ru/theme/images/license.png></a></div></div></footer><script src=//code.jquery.com/jquery-2.1.1.min.js></script><script src=https://www.insight-it.ru/theme/js/main.js?b5bb290d></script><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js ','ga');
ga('create', 'UA-3403373-1', 'auto');
ga('send', 'pageview');
</script><script type=text/javascript>(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter30650472 = new Ya.Metrika({id:30650472, webvisor:true, clickmap:true, trackLinks:true, accurateTrackBounce:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src=//mc.yandex.ru/watch/30650472 style="position:absolute; left:-9999px;" alt></div></noscript></body></html>