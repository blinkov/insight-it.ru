<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Insight IT</title><link>https://www.insight-it.ru/</link><description></description><atom:link href="https://www.insight-it.ru/tag/meropriiatie/feed/index.xml" rel="self"></atom:link><lastBuildDate>Sat, 23 Oct 2010 01:23:00 +0400</lastBuildDate><item><title>Facebook: how we scaled to 500 000 000 users by Robert Johnson</title><link>https://www.insight-it.ru//event/2010/facebook-how-we-scaled-to-500-000-000-users-by-robert-johnson/</link><description>&lt;p&gt;Буквально только что вернулся после насыщенного дня, большую часть
которого я провел на &lt;a href="https://www.insight-it.ru/goto/8f4b055f/" rel="nofollow" target="_blank" title="http://2010.russianinternetweek.ru/"&gt;RIW2010&lt;/a&gt; (о
котором я надеюсь успеть полноценно написать в воскресенье), а вечером я
очень рад что собрался таки съездить на выступления Robert Johnson под
названием &lt;a href="https://www.insight-it.ru/goto/ff11ad2b/" rel="nofollow" target="_blank" title="http://styleru.timepad.ru/event/3571"&gt;"Facebook: how we scaled to 500 000 000
users"&lt;/a&gt; в ГУ-ВШЭ (где я собственно
на данный момент и учусь в магистратуре). Сейчас же я хотел бы
сосредоточиться именно на последнем мероприятии, благо оно мало того что
было существенно более качественным, чем остальные выступления, на
которых я был последнее время, так еще и очень сильно коррелирует как в
целом с общей нитью данного блога, так и с последним постом в
частности.
&lt;!--more--&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Прежде чем читать дальше, настоятельно рекомендую
ознакомиться с &lt;a href="https://www.insight-it.ru/highload/2010/arkhitektura-facebook/"&gt;архитектурой
Facebook&lt;/a&gt;
(которую я обновил немного), здесь я постараюсь особо не повторяться и
рассказать лишь об общих впечатлениях и новых фактах, которые мне
удалось услышать и выяснить.&lt;/em&gt;\&lt;/p&gt;
&lt;p&gt;Само выступление длилось всего пол часа, было абсолютно без технических
подробностей - немного понтов о своих достижениях в плане аудитории и
нагрузки (собственно говоря первым слайдом был график роста аудитории по
годам), а затем базовые вещи оb построении высоконагруженных систем в
духе мол, что масштабироваться надо горизонтально, внимательно следить
за SPOF, быстро двигаться вперед с использованием небольших итераций в
разработке и.т.п. Аудитория слушала с очень напряженными лицами - для
многих определенно было много незнакомых слов и вообще довольно суровое
скороговорочное американское произношение мало кому давалось легко на
слух.&lt;/p&gt;
&lt;p&gt;Технических вопросов было довольно мало (что впрочем не удивительно,
т.к. мероприятие проходило в гуманитарном ВУЗе) - превалировали вопросы
в духе "что вы делаете с профилями умерших людей" (есть процедура когда
друзья/родственники сообщают и если оказывается правдой то специальным
образом перенастраивают аккаунт, чуть ли не несколько миллионов таких
случаев было), "как работает фича Х" (из интересных фич - скрытие фоток
твоих бывших boy/girl friend'ов через face recognition), "как выглядит
типичный день разработчика в Facebook" (2/3 пишут код, остальное -
всякие остальные виды деятельности), "какие планы развития в России и
мире" или "что думаете о конкурентах" (их позиция - делать лучший
продукт на рынке и аудитория сама подтянется), еще спрашивали снимался
ли он в фильме, о котором последнее время в рунете слухи ходят. Недавно
еще у них открылся небольшой венчурный фонд для инвестиций в социальные
проекты. Вообще сессия публичных ответов-вопросов длилась около часа и
потом еще где-то с полчаса он активно общался с людьми лично, тоже с ним
поговорил немного.&amp;nbsp; Под конец общение почти превратилось в фотосессию, я
тоже вот решил за компанию сфотографироваться:&lt;/p&gt;
&lt;p&gt;&lt;img alt='"Robert Johnson and Ivan Blinkov"' class="responsive-img" src="https://www.insight-it.ru/images/Robert-Johnson-and-Ivan-Blinkov.jpg" title="Robert Johnson and Ivan Blinkov"/&gt;&lt;/p&gt;
&lt;p&gt;Пожалуй хватит воды, перейдем к делу, собственно что же нового для себя
я узнал на мероприятии:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;С примерно первой половины года их официальная активная аудитория
    повысилась с 400 до 500 миллионов человек&lt;/li&gt;
&lt;li&gt;Штат инженеров (т.е. по-нашему разработчиков и сис. администраторов)
    увеличился до \~500 человек, примерно стало понятно как они
    распределены:&lt;ul&gt;
&lt;li&gt;Основной принцип: много небольших узкоспециализированных команд,
    которым даны полномочия принимать решения и проводить полностью
    продукт от стадии идеи до стадии реализации&lt;/li&gt;
&lt;li&gt;Около половины работают в "продуктовых" командах, до 5-10
    человек в каждой (фотографии, поиск, личные сообщения, и.т.п.)&lt;/li&gt;
&lt;li&gt;Ряд команд, занимающихся общими вопросами (например 4 человека
    работают над оптимизацией &lt;a href="/tag/mysql/"&gt;MySQL&lt;/a&gt;, еще есть команды
    по безопасности, приватности, производительности)&lt;/li&gt;
&lt;li&gt;Нестрогий менеджмент, 2 уровня управления&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Используются аппаратные балансировщики нагрузки от
    &lt;a href="https://www.insight-it.ru/goto/26d35856/" rel="nofollow" target="_blank" title="http://www.f5.com"&gt;F5&lt;/a&gt; + некое опенсорсное решение, сказал что
    возможно &lt;a href="/tag/nginx/"&gt;nginx&lt;/a&gt;, но он не уверен&lt;/li&gt;
&lt;li&gt;Виртуализация совсем не используется - на таком масштабе она не
    актуальна&lt;/li&gt;
&lt;li&gt;MySQL-сервера используют подключенные напрямую массивы дисков
    (direct attached storage)&lt;/li&gt;
&lt;li&gt;По вопросам мониторинга кое-где используются nagios и ganglia, но
    большая часть данной подсистемы написано самостоятельно&lt;/li&gt;
&lt;li&gt;Десятки тысяч серверов и десятки гигабит трафика, более точных цифр,
    к сожалению, не дали&lt;/li&gt;
&lt;li&gt;Коммерческого программное обеспечение практически не используется,
    по большей части собственные разработки и в ключевых местах
    opensource&lt;/li&gt;
&lt;li&gt;Сам спросил про датацентры:&lt;ul&gt;
&lt;li&gt;Santa Clara, California - master (названия мест плохо расслышал,
    поправьте если ошибаюсь)&lt;/li&gt;
&lt;li&gt;Ashburn, Virginia - read-only slave&lt;/li&gt;
&lt;li&gt;За пределами США присутствие очень небольшое, по паре стоек в
    нескольких странах - если я правильно понял, то для кэширования
    статики, т.е. своя CDN&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Помимо этого мне было интересно про репликацию между ними:&lt;ul&gt;
&lt;li&gt;Используется модифицированный механизм встроенной репликации
    MySQL&lt;/li&gt;
&lt;li&gt;Основные доработки:&amp;nbsp; передача помимо собственно данных списка
    идентификаторов объектов, которые следует инвалидировать из-за
    текущего обновления + какая-то хитрая система расстоновки флагов
    о текущем состоянии процесса репликации&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;DDoS их особо не волнует - сколько-либо серьезных попыток они не
    встречали, защита аппаратная на уровне ДЦ, как я понял&lt;/li&gt;
&lt;li&gt;Намного больше внимания уделяется модерации контента и борьбе со
    спамом&lt;/li&gt;
&lt;li&gt;Развертывание делается максимально плавно, как в плане обновления
    софта, так и в плане выкатывания новых версий кода сайта (упоминал в
    статье про архитектуру)&lt;/li&gt;
&lt;li&gt;Их позиция касательно opensource:&lt;ul&gt;
&lt;li&gt;Активно использовать и возвращать взамен с улучшениями&lt;/li&gt;
&lt;li&gt;Facebook выгодно возвращать вносимые изменения в популярные
    opensource проекты, так как они не считают их конкурентным
    преимуществом (ну и лицензии никто не отменял)&lt;/li&gt;
&lt;li&gt;Если это не делается, то чаще всего т.к. либо используются
    "грязные хаки и костыли", которые никому кроме них не нужны,
    либо так как разработчикам не хватает времени привести патч в
    удобоваримый вид&lt;/li&gt;
&lt;li&gt;Свои проекта также активно публикуются, так как организации
    вроде Apache Software Foundation берут на себя многие вопросы по
    поддержке и развитию кода&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Apache Hadoop как уже многие писали используется как хранилище и
    оффлайновый обработчик данных вроде логов, Hive родился как
    надстройка для упрощения доступа&lt;/li&gt;
&lt;li&gt;Хоть сотрудники Facebook и реализовали проект Cassandra, про который
    активно спрашивали в комментариях как тут, так и на хабре, но они
    его практически не используют у себя. Как известно он опубликован в
    opensource и поддерживается ASF. В Facebook он
    используется (использовался?) только как хранилище для &lt;em&gt;поиска&lt;/em&gt; по
    внутренним сообщениям, мотивация: очень быстрая запись,
    недостаточная производительность операций случайного чтения&lt;/li&gt;
&lt;li&gt;На вопрос про основной дистрибутив линукс и вендоров оборудования он
    был не особо уверен, но сказал что скорее всего использутся CentOS и
    они работают с несколькими основными вендорами серверов (HP, IBM,
    Dell) - свое оборудование (как Google) они не изобретают, так как не
    считают целесообразным&lt;/li&gt;
&lt;li&gt;Используется довольно сильно модифицированное ядро ОС, особенно по
    части сетевого стека&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Иван Блинков</dc:creator><pubDate>Sat, 23 Oct 2010 01:23:00 +0400</pubDate><guid>tag:www.insight-it.ru,2010-10-23:event/2010/facebook-how-we-scaled-to-500-000-000-users-by-robert-johnson/</guid><category>Facebook</category><category>HSE</category><category>Robert Johnson</category><category>ВШЭ</category><category>выступление</category><category>лекция</category><category>масштабирование</category><category>мероприятие</category><category>разработка</category></item></channel></rss>